!function t(e,n,r){function o(i,s){if(!n[i]){if(!e[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=n[i]={exports:{}};e[i][0].call(c.exports,function(t){var n=e[i][1][t];return o(n?n:t)},c,c.exports,t,e,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(t,e,n){"undefined"==typeof tnt&&(tnt={}),tnt.board=t("tnt.genome"),tnt.utils=t("tnt.utils"),tnt.tooltip=t("tnt.tooltip"),e.exports=t("./index.js")},{"./index.js":2,"tnt.genome":23,"tnt.tooltip":58,"tnt.utils":62}],2:[function(t,e,n){e.exports=targetGenomeBrowser=t("./src/targetGenomeBrowser.js")},{"./src/targetGenomeBrowser.js":70}],3:[function(t,e,n){e.exports=cttvApi=t("./src/cttvApi.js")},{"./src/cttvApi.js":18}],4:[function(t,e,n){(function(n,r){(function(){"use strict";function o(t){return"function"==typeof t||"object"==typeof t&&null!==t}function a(t){return"function"==typeof t}function i(t){return"object"==typeof t&&null!==t}function s(t){V=t}function u(t){K=t}function c(){var t=n.nextTick,e=n.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(e)&&"0"===e[1]&&"10"===e[2]&&(t=setImmediate),function(){t(h)}}function l(){return function(){U(h)}}function f(){var t=0,e=new Q(h),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function p(){var t=new MessageChannel;return t.port1.onmessage=h,function(){t.port2.postMessage(0)}}function d(){return function(){setTimeout(h,1)}}function h(){for(var t=0;$>t;t+=2){var e=et[t],n=et[t+1];e(n),et[t]=void 0,et[t+1]=void 0}$=0}function v(){try{var e=t,n=e("vertx");return U=n.runOnLoop||n.runOnContext,l()}catch(r){return d()}}function g(){}function m(){return new TypeError("You cannot resolve a promise with itself")}function _(){return new TypeError("A promises callback cannot return that same promise.")}function y(t){try{return t.then}catch(e){return at.error=e,at}}function b(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function w(t,e,n){K(function(t){var r=!1,o=b(n,e,function(n){r||(r=!0,e!==n?A(t,n):T(t,n))},function(e){r||(r=!0,R(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,R(t,o))},t)}function x(t,e){e._state===rt?T(t,e._result):e._state===ot?R(t,e._result):E(e,void 0,function(e){A(t,e)},function(e){R(t,e)})}function k(t,e){if(e.constructor===t.constructor)x(t,e);else{var n=y(e);n===at?R(t,at.error):void 0===n?T(t,e):a(n)?w(t,e,n):T(t,e)}}function A(t,e){t===e?R(t,m()):o(e)?k(t,e):T(t,e)}function j(t){t._onerror&&t._onerror(t._result),O(t)}function T(t,e){t._state===nt&&(t._result=e,t._state=rt,0!==t._subscribers.length&&K(O,t))}function R(t,e){t._state===nt&&(t._state=ot,t._result=e,K(j,t))}function E(t,e,n,r){var o=t._subscribers,a=o.length;t._onerror=null,o[a]=e,o[a+rt]=n,o[a+ot]=r,0===a&&t._state&&K(O,t)}function O(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,o,a=t._result,i=0;i<e.length;i+=3)r=e[i],o=e[i+n],r?q(n,r,o,a):o(a);t._subscribers.length=0}}function P(){this.error=null}function C(t,e){try{return t(e)}catch(n){return it.error=n,it}}function q(t,e,n,r){var o,i,s,u,c=a(n);if(c){if(o=C(n,r),o===it?(u=!0,i=o.error,o=null):s=!0,e===o)return void R(e,_())}else o=r,s=!0;e._state!==nt||(c&&s?A(e,o):u?R(e,i):t===rt?T(e,o):t===ot&&R(e,o))}function S(t,e){try{e(function(e){A(t,e)},function(e){R(t,e)})}catch(n){R(t,n)}}function N(t,e){var n=this;n._instanceConstructor=t,n.promise=new t(g),n._validateInput(e)?(n._input=e,n.length=e.length,n._remaining=e.length,n._init(),0===n.length?T(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&T(n.promise,n._result))):R(n.promise,n._validationError())}function z(t){return new st(this,t).promise}function I(t){function e(t){A(o,t)}function n(t){R(o,t)}var r=this,o=new r(g);if(!Y(t))return R(o,new TypeError("You must pass an array to race.")),o;for(var a=t.length,i=0;o._state===nt&&a>i;i++)E(r.resolve(t[i]),void 0,e,n);return o}function M(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(g);return A(n,t),n}function F(t){var e=this,n=new e(g);return R(n,t),n}function H(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function B(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function L(t){this._id=pt++,this._state=void 0,this._result=void 0,this._subscribers=[],g!==t&&(a(t)||H(),this instanceof L||B(),S(this,t))}function D(){var t;if("undefined"!=typeof r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;(!n||"[object Promise]"!==Object.prototype.toString.call(n.resolve())||n.cast)&&(t.Promise=dt)}var G;G=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var U,V,X,Y=G,$=0,K=({}.toString,function(t,e){et[$]=t,et[$+1]=e,$+=2,2===$&&(V?V(h):X())}),J="undefined"!=typeof window?window:void 0,W=J||{},Q=W.MutationObserver||W.WebKitMutationObserver,Z="undefined"!=typeof n&&"[object process]"==={}.toString.call(n),tt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,et=new Array(1e3);X=Z?c():Q?f():tt?p():void 0===J&&"function"==typeof t?v():d();var nt=void 0,rt=1,ot=2,at=new P,it=new P;N.prototype._validateInput=function(t){return Y(t)},N.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},N.prototype._init=function(){this._result=new Array(this.length)};var st=N;N.prototype._enumerate=function(){for(var t=this,e=t.length,n=t.promise,r=t._input,o=0;n._state===nt&&e>o;o++)t._eachEntry(r[o],o)},N.prototype._eachEntry=function(t,e){var n=this,r=n._instanceConstructor;i(t)?t.constructor===r&&t._state!==nt?(t._onerror=null,n._settledAt(t._state,e,t._result)):n._willSettleAt(r.resolve(t),e):(n._remaining--,n._result[e]=t)},N.prototype._settledAt=function(t,e,n){var r=this,o=r.promise;o._state===nt&&(r._remaining--,t===ot?R(o,n):r._result[e]=n),0===r._remaining&&T(o,r._result)},N.prototype._willSettleAt=function(t,e){var n=this;E(t,void 0,function(t){n._settledAt(rt,e,t)},function(t){n._settledAt(ot,e,t)})};var ut=z,ct=I,lt=M,ft=F,pt=0,dt=L;L.all=ut,L.race=ct,L.resolve=lt,L.reject=ft,L._setScheduler=s,L._setAsap=u,L._asap=K,L.prototype={constructor:L,then:function(t,e){var n=this,r=n._state;if(r===rt&&!t||r===ot&&!e)return this;var o=new this.constructor(g),a=n._result;if(r){var i=arguments[r-1];K(function(){q(r,o,i,a)})}else E(n,o,t,e);return o},"catch":function(t){return this.then(null,t)}};var ht=D,vt={Promise:dt,polyfill:ht};"function"==typeof define&&define.amd?define(function(){return vt}):"undefined"!=typeof e&&e.exports?e.exports=vt:"undefined"!=typeof this&&(this.ES6Promise=vt),ht()}).call(this)}).call(this,t("IrXUsu"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{IrXUsu:19}],5:[function(t,e,n){"use strict";!function(t,r){"function"==typeof define&&define.amd?define(function(){return t.httppleasepromises=r(t)}):"object"==typeof n?e.exports=r(t):t.httppleasepromises=r(t)}(this,function(t){return function(e){if(e=e||t&&t.Promise,!e)throw new Error("No Promise implementation found.");return{processRequest:function(t){var n,r,o=t.onload,a=t.onerror,i=new e(function(t,e){n=t,r=e});t.onload=function(t){var e;return o&&(e=o.apply(this,arguments)),n(t),e},t.onerror=function(t){var e;return a&&(e=a.apply(this,arguments)),r(t),e},t.then=function(){return i.then.apply(i,arguments)},t["catch"]=function(){return i["catch"].apply(i,arguments)}}}}})},{}],6:[function(t,e,n){"use strict";function r(t,e){var n=new Error(t);n.name="RequestError",this.name=n.name,this.message=n.message,n.stack&&(this.stack=n.stack),this.toString=function(){return this.message};for(var r in e)e.hasOwnProperty(r)&&(this[r]=e[r])}var o=t("./response");r.prototype=Error.prototype,r.create=function(t,e,n){var a=new r(t,n);return o.call(a,e),a},e.exports=r},{"./response":9}],7:[function(t,e,n){"use strict";function r(t,e){function n(n,r){var a,d,h,v,g;for(n=new l(f(t,n)),o=0;o<e.length;o++)d=e[o],d.processRequest&&d.processRequest(n);for(o=0;o<e.length;o++)if(d=e[o],d.createXHR){a=d.createXHR(n);break}a=a||new i,n.xhr=a,h=p(s(function(t){clearTimeout(g),a.onload=a.onerror=a.onreadystatechange=a.ontimeout=a.onprogress=null;var i=t&&t.isHttpError?t:new c(n);for(o=0;o<e.length;o++)d=e[o],d.processResponse&&d.processResponse(i);t?n.onerror&&n.onerror(t):n.onload&&n.onload(i),r&&r(t,i)})),a.onreadystatechange=function(){if(!n.timedOut)if(n.aborted)h(u("Request aborted",n,{name:"Abort"}));else if(4===a.readyState){var t=Math.floor(a.status/100);if(2===t)h();else if(404!==a.status||n.errorOn404){var e;switch(t){case 4:e="Client";break;case 5:e="Server";break;default:e="HTTP"}var r=e+" Error: The server returned a status of "+a.status+' for the request "'+n.method.toUpperCase()+" "+n.url+'"';h(u(r,n))}else h()}},a.onload=function(){h()},a.onerror=function(){h(u("Internal XHR Error",n))},a.ontimeout=function(){},a.onprogress=function(){},a.open(n.method,n.url),n.timeout&&(g=setTimeout(function(){n.timedOut=!0,h(u("Request timeout",n,{name:"Timeout"}));try{a.abort()}catch(t){}},n.timeout));for(v in n.headers)n.headers.hasOwnProperty(v)&&a.setRequestHeader(v,n.headers[v]);return a.send(n.body),n}t=t||{},e=e||[];var a,d=["get","post","put","head","patch","delete"],h=function(t){return function(e,r){return e=new l(e),e.method=t,n(e,r)}};for(o=0;o<d.length;o++)a=d[o],n[a]=h(a);return n.plugins=function(){return e},n.defaults=function(n){return n?r(f(t,n),e):t},n.use=function(){var n=Array.prototype.slice.call(arguments,0);return r(t,e.concat(n))},n.bare=function(){return r()},n.Request=l,n.Response=c,n}var o,a=t("../plugins/cleanurl"),i=t("./xhr"),s=t("./utils/delay"),u=t("./error").create,c=t("./response"),l=t("./request"),f=t("xtend"),p=t("./utils/once");e.exports=r({},[a])},{"../plugins/cleanurl":14,"./error":6,"./request":8,"./response":9,"./utils/delay":10,"./utils/once":11,"./xhr":12,xtend:13}],8:[function(t,e,n){"use strict";function r(t){var e="string"==typeof t?{url:t}:t||{};this.method=e.method?e.method.toUpperCase():"GET",this.url=e.url,this.headers=e.headers||{},this.body=e.body,this.timeout=e.timeout||0,this.errorOn404=null!=e.errorOn404?e.errorOn404:!0,this.onload=e.onload,this.onerror=e.onerror}r.prototype.abort=function(){return this.aborted?void 0:(this.aborted=!0,this.xhr.abort(),this)},r.prototype.header=function(t,e){var n;for(n in this.headers)if(this.headers.hasOwnProperty(n)&&t.toLowerCase()===n.toLowerCase()){if(1===arguments.length)return this.headers[n];delete this.headers[n];break}return null!=e?(this.headers[t]=e,e):void 0},e.exports=r},{}],9:[function(t,e,n){"use strict";function r(t){var e,n,r,o=t.xhr;if(this.request=t,this.xhr=o,this.headers={},!t.aborted&&!t.timedOut){if(this.status=o.status||0,this.text=o.responseText,this.body=o.response||o.responseText,this.contentType=o.contentType||o.getResponseHeader&&o.getResponseHeader("Content-Type"),o.getAllResponseHeaders)for(n=o.getAllResponseHeaders().split("\n"),e=0;e<n.length;e++)(r=n[e].match(/\s*([^\s]+):\s+([^\s]+)/))&&(this.headers[r[1]]=r[2]);this.isHttpError=this.status>=400}}var o=t("./request");r.prototype.header=o.prototype.header,e.exports=r},{"./request":8}],10:[function(t,e,n){"use strict";e.exports=function(t){return function(){var e=Array.prototype.slice.call(arguments,0),n=function(){return t.apply(null,e)};setTimeout(n,0)}}},{}],11:[function(t,e,n){"use strict";e.exports=function(t){var e,n=!1;return function(){return n||(n=!0,e=t.apply(this,arguments)),e}}},{}],12:[function(t,e,n){e.exports=window.XMLHttpRequest},{}],13:[function(t,e,n){function r(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}return t}e.exports=r},{}],14:[function(t,e,n){"use strict";e.exports={processRequest:function(t){t.url=t.url.replace(/[^%]+/g,function(t){return encodeURI(t)})}}},{}],15:[function(t,e,n){"use strict";var r=t("./jsonrequest"),o=t("./jsonresponse");e.exports={processRequest:function(t){r.processRequest.call(this,t),o.processRequest.call(this,t)},processResponse:function(t){o.processResponse.call(this,t)}}},{"./jsonrequest":16,"./jsonresponse":17}],16:[function(t,e,n){"use strict";e.exports={processRequest:function(t){var e=t.header("Content-Type"),n=e&&-1!==e.indexOf("application/json");(null==e||n)&&t.body&&(e||t.header("Content-Type","application/json"),t.body=JSON.stringify(t.body))}}},{}],17:[function(t,e,n){"use strict";e.exports={processRequest:function(t){var e=t.header("Accept");null==e&&t.header("Accept","application/json")},processResponse:function(t){if(t.contentType&&/^.*\/(?:.*\+)?json(;|$)/i.test(t.contentType)){var e="string"==typeof t.body?t.body:t.text;e&&(t.body=JSON.parse(e))}}}},{}],18:[function(t,e,n){var r=t("httpplease"),o=t("httpplease-promises"),a=t("es6-promise").Promise,i=t("httpplease/plugins/json");jsonHttp=r.use(i).use(o(a)),r=r.use(o(a));var s=function(){var t="https://beta.targetvalidation.org/api/latest/",e="filterby?",n="association?",r="search?",o="gene/",a="disease/",i="auth/request_token?",s="autocomplete?",u="quicksearch?",c="expression?",l="proxy/generic/",f="target/",p={token:"",appname:"",secret:""},d=function(t){console.log(t)},h=function(){var t=v.url.requestToken(p);return jsonHttp.get({url:t})},v={};v.call=function(t,e,n){return p.token||p.appname||p.secret?p.token?jsonHttp.get({url:t,headers:{"Auth-token":p.token}},e)["catch"](function(r){return d(r),p.token="",v.call(t,e,n)}):h().then(function(r){var o,a={"Auth-token":r.body.token};return o=n?jsonHttp.post({url:t,headers:a,body:n}):jsonHttp.get({url:t,headers:a},e)["catch"](d)}):(console.log("    CttvApi running in non-authentication mode"),n?jsonHttp.post({url:t,body:n}):jsonHttp.get({url:t},e))},v.onError=function(t){return arguments.length?(d=t,this):d},v.appname=function(t){return arguments.length?(p.appname=t,this):p.appname},v.secret=function(t){return arguments.length?(p.secret=t,this):p.secret},v.token=function(t){return arguments.length?(p.token=t,this):p.token},v.prefix=function(e){return arguments.length?(t=e,this):t},v.url={},v.url.gene=function(e){return t+o+e.gene_id},v.url.target=function(e){return t+f+e.target_id},v.url.disease=function(e){return t+a+e.code},v.url.search=function(e){return t+r+g(e)},v.url.associations=function(e){return t+n+g(e)},v.url.filterby=function(n){return t+e+g(n)},v.url.requestToken=function(e){return t+i+"appname="+e.appname+"&secret="+e.secret},v.url.autocomplete=function(e){return t+s+g(e)},v.url.quickSearch=function(e){return t+u+g(e)},v.url.expression=function(e){return t+c+g(e)},v.url.proxy=function(e){return t+l+e.url};var g=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&(t[n].constructor===Array?e.push(n+"="+t[n].join("&"+n+"=")):e.push(n+"="+t[n]));return e.join("&")};return v};e.exports=s},{"es6-promise":4,httpplease:7,"httpplease-promises":5,"httpplease/plugins/json":15}],19:[function(t,e,n){function r(){}var o=e.exports={};o.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),o.title="browser",o.browser=!0,o.env={},o.argv=[],o.on=r,o.addListener=r,o.once=r,o.off=r,o.removeListener=r,o.removeAllListeners=r,o.emit=r,o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],20:[function(t,e,n){(function(n,r){(function(){"use strict";function o(t){return"function"==typeof t||"object"==typeof t&&null!==t}function a(t){return"function"==typeof t}function i(t){return"object"==typeof t&&null!==t}function s(){}function u(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return n;return-1}function c(t){var e=t._promiseCallbacks;return e||(e=t._promiseCallbacks={}),e}function l(t,e){return"onerror"===t?void jt.on("error",e):2!==arguments.length?jt[t]:void(jt[t]=e)}function f(){setTimeout(function(){for(var t,e=0;e<Tt.length;e++){t=Tt[e];var n=t.payload;n.guid=n.key+n.id,n.childGuid=n.key+n.childId,n.error&&(n.stack=n.error.stack),jt.trigger(t.name,t.payload)}Tt.length=0},50)}function p(t,e,n){1===Tt.push({name:t,payload:{key:e._guidKey,id:e._id,eventName:t,detail:e._result,childId:n&&n._id,label:e._label,timeStamp:xt(),error:jt["instrument-with-stack"]?new Error(e._label):null}})&&f()}function d(){return new TypeError("A promises callback cannot return that same promise.")}function h(){}function v(t){try{return t.then}catch(e){return Ct.error=e,Ct}}function g(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function m(t,e,n){jt.async(function(t){var r=!1,o=g(n,e,function(n){r||(r=!0,e!==n?b(t,n):x(t,n))},function(e){r||(r=!0,k(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,k(t,o))},t)}function _(t,e){e._state===Ot?x(t,e._result):e._state===Pt?(e._onError=null,k(t,e._result)):A(e,void 0,function(n){e!==n?b(t,n):x(t,n)},function(e){k(t,e)})}function y(t,e){if(e.constructor===t.constructor)_(t,e);else{var n=v(e);n===Ct?k(t,Ct.error):void 0===n?x(t,e):a(n)?m(t,e,n):x(t,e)}}function b(t,e){t===e?x(t,e):o(e)?y(t,e):x(t,e)}function w(t){t._onError&&t._onError(t._result),j(t)}function x(t,e){t._state===Et&&(t._result=e,t._state=Ot,0===t._subscribers.length?jt.instrument&&Rt("fulfilled",t):jt.async(j,t))}function k(t,e){t._state===Et&&(t._state=Pt,t._result=e,jt.async(w,t))}function A(t,e,n,r){var o=t._subscribers,a=o.length;t._onError=null,o[a]=e,o[a+Ot]=n,o[a+Pt]=r,0===a&&t._state&&jt.async(j,t)}function j(t){var e=t._subscribers,n=t._state;if(jt.instrument&&Rt(n===Ot?"fulfilled":"rejected",t),0!==e.length){for(var r,o,a=t._result,i=0;i<e.length;i+=3)r=e[i],o=e[i+n],r?E(n,r,o,a):o(a);t._subscribers.length=0}}function T(){this.error=null}function R(t,e){try{return t(e)}catch(n){return qt.error=n,qt}}function E(t,e,n,r){var o,i,s,u,c=a(n);if(c){if(o=R(n,r),o===qt?(u=!0,i=o.error,o=null):s=!0,e===o)return void k(e,d())}else o=r,s=!0;e._state!==Et||(c&&s?b(e,o):u?k(e,i):t===Ot?x(e,o):t===Pt&&k(e,o))}function O(t,e){var n=!1;try{e(function(e){n||(n=!0,b(t,e))},function(e){n||(n=!0,k(t,e))})}catch(r){k(t,r)}}function P(t,e,n){return t===Ot?{state:"fulfilled",value:n}:{state:"rejected",reason:n}}function C(t,e,n,r){var o=this;o._instanceConstructor=t,o.promise=new t(h,r),o._abortOnReject=n,o._validateInput(e)?(o._input=e,o.length=e.length,o._remaining=e.length,o._init(),0===o.length?x(o.promise,o._result):(o.length=o.length||0,o._enumerate(),0===o._remaining&&x(o.promise,o._result))):k(o.promise,o._validationError())}function q(t,e){return new St(this,t,!0,e).promise}function S(t,e){function n(t){b(a,t)}function r(t){k(a,t)}var o=this,a=new o(h,e);if(!wt(t))return k(a,new TypeError("You must pass an array to race.")),a;for(var i=t.length,s=0;a._state===Et&&i>s;s++)A(o.resolve(t[s]),void 0,n,r);return a}function N(t,e){var n=this;if(t&&"object"==typeof t&&t.constructor===n)return t;var r=new n(h,e);return b(r,t),r}function z(t,e){var n=this,r=new n(h,e);return k(r,t),r}function I(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function M(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function F(t,e){var n=this;n._id=Ht++,n._label=e,n._state=void 0,n._result=void 0,n._subscribers=[],jt.instrument&&Rt("created",n),h!==t&&(a(t)||I(),n instanceof F||M(),O(n,t))}function H(t,e,n){this._superConstructor(t,e,!1,n)}function B(t,e){return new H(Bt,t,e).promise}function L(t,e){return Bt.all(t,e)}function D(t,e){Qt[Vt]=t,Qt[Vt+1]=e,Vt+=2,2===Vt&&Dt()}function G(){var t=n.nextTick,e=n.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(e)&&"0"===e[1]&&"10"===e[2]&&(t=setImmediate),function(){t($)}}function U(){return function(){Lt($)}}function V(){var t=0,e=new Kt($),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function X(){var t=new MessageChannel;return t.port1.onmessage=$,function(){t.port2.postMessage(0)}}function Y(){return function(){setTimeout($,1)}}function $(){for(var t=0;Vt>t;t+=2){var e=Qt[t],n=Qt[t+1];e(n),Qt[t]=void 0,Qt[t+1]=void 0}Vt=0}function K(){try{var e=t,n=e("vertx");return Lt=n.runOnLoop||n.runOnContext,U()}catch(r){return Y()}}function J(t){var e={};return e.promise=new Bt(function(t,n){e.resolve=t,e.reject=n},t),e}function W(t,e,n){return Bt.all(t,n).then(function(t){if(!a(e))throw new TypeError("You must pass a function as filter's second argument.");for(var r=t.length,o=new Array(r),i=0;r>i;i++)o[i]=e(t[i]);return Bt.all(o,n).then(function(e){for(var n=new Array(r),o=0,a=0;r>a;a++)e[a]&&(n[o]=t[a],o++);return n.length=o,n})})}function Q(t,e,n){this._superConstructor(t,e,!0,n)}function Z(t,e,n){this._superConstructor(t,e,!1,n)}function tt(t,e){return new Z(Bt,t,e).promise}function et(t,e){return new ee(Bt,t,e).promise}function nt(t,e,n){return Bt.all(t,n).then(function(t){if(!a(e))throw new TypeError("You must pass a function as map's second argument.");for(var r=t.length,o=new Array(r),i=0;r>i;i++)o[i]=e(t[i]);return Bt.all(o,n)})}function rt(){this.value=void 0}function ot(t){try{return t.then}catch(e){return ie.value=e,ie}}function at(t,e,n){try{t.apply(e,n)}catch(r){return ie.value=r,ie}}function it(t,e){for(var n,r,o={},a=t.length,i=new Array(a),s=0;a>s;s++)i[s]=t[s];for(r=0;r<e.length;r++)n=e[r],o[n]=i[r+1];return o}function st(t){for(var e=t.length,n=new Array(e-1),r=1;e>r;r++)n[r-1]=t[r];return n}function ut(t,e){return{then:function(n,r){return t.call(e,n,r)}}}function ct(t,e){var n=function(){for(var n,r=this,o=arguments.length,a=new Array(o+1),i=!1,s=0;o>s;++s){if(n=arguments[s],!i){if(i=pt(n),i===se){var u=new Bt(h);return k(u,se.value),u}i&&i!==!0&&(n=ut(i,n))}a[s]=n}var c=new Bt(h);return a[o]=function(t,n){t?k(c,t):void 0===e?b(c,n):e===!0?b(c,st(arguments)):wt(e)?b(c,it(arguments,e)):b(c,n)},i?ft(c,a,t,r):lt(c,a,t,r)};return n.__proto__=t,n}function lt(t,e,n,r){var o=at(n,r,e);return o===ie&&k(t,o.value),t}function ft(t,e,n,r){return Bt.all(e).then(function(e){var o=at(n,r,e);return o===ie&&k(t,o.value),t})}function pt(t){return t&&"object"==typeof t?t.constructor===Bt?!0:ot(t):!1}function dt(t,e){return Bt.race(t,e)}function ht(t,e){return Bt.reject(t,e)}function vt(t,e){return Bt.resolve(t,e)}function gt(t){throw setTimeout(function(){throw t}),t}function mt(t,e){jt.async(t,e)}function _t(){jt.on.apply(jt,arguments)}function yt(){jt.off.apply(jt,arguments)}var bt;bt=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var wt=bt,xt=Date.now||function(){return(new Date).getTime()},kt=Object.create||function(t){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof t)throw new TypeError("Argument must be an object");return s.prototype=t,new s},At={mixin:function(t){return t.on=this.on,t.off=this.off,t.trigger=this.trigger,t._promiseCallbacks=void 0,t},on:function(t,e){if("function"!=typeof e)throw new TypeError("Callback must be a function");var n,r=c(this);n=r[t],n||(n=r[t]=[]),-1===u(n,e)&&n.push(e)},off:function(t,e){var n,r,o=c(this);return e?(n=o[t],r=u(n,e),void(-1!==r&&n.splice(r,1))):void(o[t]=[])},trigger:function(t,e,n){var r,o,a=c(this);if(r=a[t])for(var i=0;i<r.length;i++)(o=r[i])(e,n)}},jt={instrument:!1};At.mixin(jt);var Tt=[],Rt=p,Et=void 0,Ot=1,Pt=2,Ct=new T,qt=new T,St=C;C.prototype._validateInput=function(t){return wt(t)},C.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},C.prototype._init=function(){this._result=new Array(this.length)},C.prototype._enumerate=function(){for(var t=this,e=t.length,n=t.promise,r=t._input,o=0;n._state===Et&&e>o;o++)t._eachEntry(r[o],o)},C.prototype._eachEntry=function(t,e){var n=this,r=n._instanceConstructor;i(t)?t.constructor===r&&t._state!==Et?(t._onError=null,n._settledAt(t._state,e,t._result)):n._willSettleAt(r.resolve(t),e):(n._remaining--,n._result[e]=n._makeResult(Ot,e,t))},C.prototype._settledAt=function(t,e,n){var r=this,o=r.promise;o._state===Et&&(r._remaining--,r._abortOnReject&&t===Pt?k(o,n):r._result[e]=r._makeResult(t,e,n)),0===r._remaining&&x(o,r._result)},C.prototype._makeResult=function(t,e,n){return n},C.prototype._willSettleAt=function(t,e){var n=this;A(t,void 0,function(t){n._settledAt(Ot,e,t)},function(t){n._settledAt(Pt,e,t)})};var Nt=q,zt=S,It=N,Mt=z,Ft="rsvp_"+xt()+"-",Ht=0,Bt=F;F.cast=It,F.all=Nt,F.race=zt,F.resolve=It,F.reject=Mt,F.prototype={constructor:F,_guidKey:Ft,_onError:function(t){var e=this;jt.after(function(){e._onError&&jt.trigger("error",t,e._label)})},then:function(t,e,n){var r=this,o=r._state;if(o===Ot&&!t||o===Pt&&!e)return jt.instrument&&Rt("chained",r,r),r;r._onError=null;var a=new r.constructor(h,n),i=r._result;if(jt.instrument&&Rt("chained",r,a),o){var s=arguments[o-1];jt.async(function(){E(o,a,s,i)})}else A(r,a,t,e);return a},"catch":function(t,e){return this.then(void 0,t,e)},"finally":function(t,e){var n=this,r=n.constructor;return n.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})},e)}},H.prototype=kt(St.prototype),H.prototype._superConstructor=St,H.prototype._makeResult=P,H.prototype._validationError=function(){return new Error("allSettled must be called with an array")};var Lt,Dt,Gt=B,Ut=L,Vt=0,Xt=({}.toString,D),Yt="undefined"!=typeof window?window:void 0,$t=Yt||{},Kt=$t.MutationObserver||$t.WebKitMutationObserver,Jt="undefined"==typeof self&&"undefined"!=typeof n&&"[object process]"==={}.toString.call(n),Wt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Qt=new Array(1e3);Dt=Jt?G():Kt?V():Wt?X():void 0===Yt&&"function"==typeof t?K():Y();var Zt=J,te=W,ee=Q;Q.prototype=kt(St.prototype),Q.prototype._superConstructor=St,Q.prototype._init=function(){this._result={}},Q.prototype._validateInput=function(t){return t&&"object"==typeof t},Q.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},Q.prototype._enumerate=function(){var t=this,e=t.promise,n=t._input,r=[];for(var o in n)e._state===Et&&Object.prototype.hasOwnProperty.call(n,o)&&r.push({position:o,entry:n[o]});var a=r.length;t._remaining=a;for(var i,s=0;e._state===Et&&a>s;s++)i=r[s],t._eachEntry(i.entry,i.position)},Z.prototype=kt(ee.prototype),Z.prototype._superConstructor=St,Z.prototype._makeResult=P,Z.prototype._validationError=function(){return new Error("hashSettled must be called with an object")};var ne,re=tt,oe=et,ae=nt,ie=new rt,se=new rt,ue=ct;if("object"==typeof self)ne=self;else{if("object"!=typeof r)throw new Error("no global: `self` or `global` found");ne=r}var ce=ne,le=dt,fe=ht,pe=vt,de=gt;jt.async=Xt,jt.after=function(t){setTimeout(t,0)};if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var he=window.__PROMISE_INSTRUMENTATION__;l("instrument",!0);for(var ve in he)he.hasOwnProperty(ve)&&_t(ve,he[ve])}var ge={race:le,Promise:Bt,allSettled:Gt,hash:oe,hashSettled:re,denodeify:ue,on:_t,off:yt,map:ae,filter:te,resolve:pe,reject:fe,all:Ut,rethrow:de,defer:Zt,EventTarget:At,configure:l,async:mt};"function"==typeof define&&define.amd?define(function(){return ge}):"undefined"!=typeof e&&e.exports?e.exports=ge:"undefined"!=typeof ce&&(ce.RSVP=ge)}).call(this)}).call(this,t("IrXUsu"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{IrXUsu:19}],21:[function(t,e,n){e.exports=t("./src/api.js")},{"./src/api.js":22}],22:[function(t,e,n){var r=function(t){var e=function(){var t=[];return t.add_batch=function(e){t.unshift(e)},t.update=function(e,n){for(var r=0;r<t.length;r++)for(var o in t[r])if(o===e)return t[r][o]=n,!0;return!1},t.add=function(e,n){if(t.update(e,n));else{var r={};r[e]=n,t.add_batch(r)}},t.get=function(e){for(var n=0;n<t.length;n++)for(var r in t[n])if(r===e)return t[n][r]},t},n=e(),r=function(){};r.check=function(e,n,o){if(!(e instanceof Array))return"function"==typeof e?e.check(n,o):t[e].check(n,o),r;for(var a=0;a<e.length;a++)r.check(e[a],n,o)},r.transform=function(e,n){if(!(e instanceof Array))return"function"==typeof e?e.transform(n):t[e].transform(n),r;for(var o=0;o<e.length;o++)r.transform(e[o],n)};var o=function(e,r){var o=[],a=[],i=r.on_getter||function(){return n.get(e)},s=r.on_setter||function(t){for(var r=0;r<a.length;r++)t=a[r](t);for(var i=0;i<o.length;i++)if(!o[i].check(t)){var s=o[i].msg||"Value "+t+" doesn't seem to be valid for this method";throw s}n.add(e,t)},u=function(e){return arguments.length?(s(e),t):i()};u.check=function(t,e){return arguments.length?(o.push({check:t,msg:e}),this):o},u.transform=function(t){return arguments.length?(a.push(t),this):a},t[e]=u},a=function(t,e){if("object"==typeof t){n.add_batch(t);for(var r in t)o(r,e)}else n.add(t,e.default_value),o(t,e)};return r.getset=function(t,e){return a(t,{default_value:e}),r},r.get=function(t,e){var n=function(){throw"Method defined only as a getter (you are trying to use it as a setter"};return a(t,{default_value:e,on_setter:n}),r},r.set=function(t,e){var n=function(){throw"Method defined only as a setter (you are trying to use it as a getter"};return a(t,{default_value:e,on_getter:n}),r},r.method=function(e,n){if("object"==typeof e)for(var o in e)t[o]=e[o];else t[e]=n;return r},r};e.exports=n=r},{}],23:[function(t,e,n){e.exports=t("./src/index.js")},{"./src/index.js":56}],24:[function(t,e,n){e.exports=t(21)},{"./src/api.js":25}],25:[function(t,e,n){e.exports=t(22)},{}],26:[function(t,e,n){e.exports=t("./src/index")},{"./src/index":30}],27:[function(t,e,n){var r=t("tnt.api"),o=t("tnt.utils").defer_cancel,a=function(){"use strict";function t(t){t.parentNode.appendChild(t)}var e,n,a,i,s,u=[],c=50,l=0,f=920,p=20,d={species:void 0,chr:void 0,from:0,to:500},h={left:void 0,right:void 0},v=3,g=d3.rgb("#F8FBEF"),m=d3.behavior.zoom(),_={min:0,max:1e3,zoom_out:1e3,zoom_in:100},y=500,b=!0,w={ease:d3.ease("cubic-in-out"),extend_canvas:{left:0,right:0},show_frame:!0},x=function(t){n=d3.select(t).attr("id"),d3.select(t).classed("tnt",!0);var r=d3.select(t).append("div").attr("id","tnt_"+n).style("position","relative").classed("tnt_framed",w.show_frame?!0:!1).style("width",f+2*v+w.extend_canvas.right+w.extend_canvas.left+"px"),o=r.append("div").attr("class","tnt_groupDiv");e=o.append("svg").attr("class","tnt_svg").attr("width",f).attr("height",l).attr("pointer-events","all"),i=e.append("g").attr("transform","translate(0,20)").append("g").attr("class","tnt_g"),h.left=i.append("rect").attr("id","tnt_"+n+"_5pcap").attr("x",0).attr("y",0).attr("width",0).attr("height",l).attr("fill","red"),h.right=i.append("rect").attr("id","tnt_"+n+"_3pcap").attr("x",f-v).attr("y",0).attr("width",0).attr("height",l).attr("fill","red"),a=i.append("rect").attr("class","tnt_pane").attr("id","tnt_"+n+"_pane").attr("width",f).attr("height",l).style("fill",g)},k=r(x).getset(w).getset(_).getset(d);k.transform(x.extend_canvas,function(t){var e=x.extend_canvas();return t.left=t.left||e.left,t.right=t.right||e.right,t}),k.method("start",function(){_.max-_.min<_.zoom_out&&(_.zoom_out=_.max-_.min),j();for(var t=0;t<u.length;t++)u[t].g&&u[t].g.remove(),E(u[t]);R();var e=function(){d.to-d.from<_.zoom_in&&(d.from+_.zoom_in>_.max?d.to=_.max:d.to=d.from+_.zoom_in);
for(var t=0;t<u.length;t++)A(u[t],d)};e()}),k.method("update",function(){for(var t=0;t<u.length;t++)A(u[t])});var A=function(t,e){if(t.data()){var n=t.data(),r=n;r.call(t,{loc:e,on_success:function(){t.display().update.call(t,e)}})}},j=function(){s=d3.scale.linear().domain([d.from,d.to]).range([0,f]),b&&i.call(m.x(s).scaleExtent([(d.to-d.from)/(_.zoom_out-1),(d.to-d.from)/_.zoom_in]).on("zoom",q))},T=function(t){for(var e=[],n=0;n<t.length;n++){for(var r=!1,o=0;o<u.length;o++)if(u[o].id()===t[n].id()){r=!0,e[o]=!0;break}r||(E(t[n]),A(t[n],{from:d.from,to:d.to}))}for(var a=0;a<u.length;a++)e[a]||u[a].g.remove();u=t,R()};k.method("scroll",function(t){var e=Math.abs(t);t>0?O(e,1):0>t&&O(e,-1)}),k.method("zoom",function(t){O(1/t,0)}),k.method("find_track",function(t){for(var e=0;e<u.length;e++)if(u[e].id()===t)return u[e]}),k.method("remove_track",function(t){t.g.remove()}),k.method("add_track",function(t){if(t instanceof Array){for(var e=0;e<t.length;e++)x.add_track(t[e]);return x}return u.push(t),x}),k.method("tracks",function(t){return arguments.length?(T(t),this):u}),k.method("width",function(t){if(!arguments.length)return f;if(c>t&&(t=c),void 0!==n){d3.select("#tnt_"+n).select("svg").attr("width",t),d3.select("#tnt_"+n).style("width",parseInt(t)+2*v+"px"),d3.select("#tnt_"+n+"_pane").attr("width",t),h.right.attr("x",t-v),f=t,s.range([0,f]),j();for(var e=0;e<u.length;e++)u[e].g.select("rect").attr("width",t),u[e].display().scale(s),u[e].display().reset.call(u[e]),u[e].display().init.call(u[e],t),u[e].display().update.call(u[e],d)}else f=t;return x}),k.method("allow_drag",function(t){return arguments.length?(b=t,b?void 0!==s&&i.call(m.x(s).scaleExtent([(d.to-d.from)/(_.zoom_out-1),(d.to-d.from)/_.zoom_in]).on("zoom",q)):m.x(d3.scale.linear()).on("zoom",null),x):b});var R=function(){for(var r=0,o=0;o<u.length;o++){var i=u[o];i.g.attr("transform")?i.g.transition().duration(y).attr("transform","translate("+w.extend_canvas.left+","+r+")"):i.g.attr("transform","translate("+w.extend_canvas.left+","+r+")"),r+=i.height()}return e.attr("height",r+p),d3.select("#tnt_"+n).style("height",r+10+p+"px"),d3.select("#tnt_"+n+"_5pcap").attr("height",r).each(function(e){t(this)}),d3.select("#tnt_"+n+"_3pcap").attr("height",r).each(function(e){t(this)}),a.attr("height",r+p),x},E=function(t){return t.g=e.select("g").select("g").append("g").attr("class","tnt_track").attr("height",t.height()),t.g.append("rect").attr("x",0).attr("y",0).attr("width",x.width()).attr("height",t.height()).style("fill",t.color()).style("pointer-events","none"),t.display()&&t.display().scale(s).init.call(t,f),x},O=function(t,e){var n,r=s.domain(),o=r[1]-r[0],a=o*t-o;switch(e){case 1:n=[~~r[0]-a,~~(r[1]-a)];break;case-1:n=[~~r[0]+a,~~(r[1]-a)];break;case 0:n=[r[0]-~~(a/2),r[1]+~~a/2]}var i=d3.interpolateNumber(r[0],n[0]),u=w.ease,c=0;d3.timer(function(){var t,n=i(u(c));switch(e){case-1:t=n+o;break;case 1:t=n+o;break;case 0:t=r[1]+r[0]-n}var a=[n,t];return s.domain(a),q(s),c+=.02,c>1})},P=function(){var t=s.domain();x.from(~~t[0]),x.to(~~t[1]);for(var e=0;e<u.length;e++){var n=u[e];A(n,d)}},C=o(P,300),q=function(t){void 0!==t&&b&&m.x(t);var e=s.domain();e[0]<=_.min+5&&d3.select("#tnt_"+n+"_5pcap").attr("width",v).transition().duration(200).attr("width",0),e[1]>=_.max-5&&d3.select("#tnt_"+n+"_3pcap").attr("width",v).transition().duration(200).attr("width",0),e[0]<_.min?m.translate([m.translate()[0]-s(_.min)+s.range()[0],m.translate()[1]]):e[1]>_.max&&m.translate([m.translate()[0]-s(_.max)+s.range()[1],m.translate()[1]]),C();for(var r=0;r<u.length;r++){var o=u[r];o.display().mover.call(o)}};return x};e.exports=n=a},{"tnt.api":24,"tnt.utils":62}],28:[function(t,e,n){var r=t("tnt.api"),o=t("./spinner.js")();tnt_data={},tnt_data.sync=function(){var t=function(e){var n=this;n.data().elements(t.retriever().call(n,e.loc)),e.on_success()};return r(t).getset("elements",[]).getset("retriever",function(){}),t},tnt_data.async=function(){var t=function(e){var n=this;o.on.call(n),t.retriever().call(n,e.loc).then(function(t){n.data().elements(t),e.on_success(),o.off.call(n)})};r(t).getset("elements",[]).getset("retriever");return t},tnt_data.empty=function(){var t=tnt_data.sync();return t},e.exports=n=tnt_data},{"./spinner.js":32,"tnt.api":24}],29:[function(t,e,n){var r=t("tnt.api"),o=t("./layout.js"),a=function(){var t=d3.dispatch("click","dblclick","mouseover","mouseout"),e={create:function(){throw"create_elem is not defined in the base feature object"},move:function(){throw"move_elem is not defined in the base feature object"},distribute:function(){},fixed:function(){},index:void 0,layout:o.identity(),color:"#000",scale:void 0},n={},a=function(){var t=this;t.g.selectAll(".tnt_elem").remove(),t.g.selectAll(".tnt_guider").remove()},i=function(t){var n=this;n.g.append("text").attr("x",5).attr("y",12).attr("font-size",11).attr("fill","grey").text(n.label()),e.fixed.call(n,t)},s=function(n,r,o){n.on("click",function(e,n){d3.event.defaultPrevented||t.click.call(this,e,n)}),n.on("mouseover",function(e,n){d3.event.defaultPrevented||t.mouseover.call(this,e,n)}),n.on("dblclick",function(e,n){d3.event.defaultPrevented||t.dblclick.call(this,e,n)}),n.on("mouseout",function(e,n){d3.event.defaultPrevented||t.mouseout.call(this,e,n)}),e.create.call(r,n,o)},u=function(t,r){var o=this,a=o.g,i=o.data().elements();void 0!==r&&(i=i[r]);var s=e.layout.call(o,i);if(void 0!==s){var u,c;u=void 0!==r?a.selectAll(".tnt_elem_"+r):a.selectAll(".tnt_elem"),c=e.index?u.data(s,function(t){return void 0!==t?e.index(t):void 0}):u.data(s),e.distribute.call(o,c,e.scale);var l=c.enter();l.append("g").attr("class","tnt_elem").classed("tnt_elem_"+r,r).call(n.plot,o,e.scale),c.exit().remove()}},c=function(t){var n,r=this,o=r.g;n=void 0!==t?o.selectAll(".tnt_elem_"+t):o.selectAll(".tnt_elem"),e.move.call(this,n)},l=function(t){t.parentNode.appendChild(t)},f=function(t){if(void 0!==t){var e=this,n=e.g;n.selectAll(".tnt_elem_"+t).each(function(){l(this)})}};return r(n).getset(e).method({reset:a,plot:s,update:u,mover:c,init:i,move_to_front:f}),d3.rebind(n,t,"on")};a.composite=function(){var t={},e=[],n={},o=function(){for(var e=this,n=0;n<t.length;n++)t[n].reset.call(e)},a=function(e){var r=this;for(var o in t)t.hasOwnProperty(o)&&(t[o].scale(n.scale()),t[o].init.call(r,e))},i=function(){for(var n=this,r=0;r<e.length;r++)t[e[r]].update.call(n,void 0,e[r]),t[e[r]].move_to_front.call(n,e[r])},s=function(){var e=this;for(var n in t)t.hasOwnProperty(n)&&t[n].mover.call(e,n)},u=function(r,o){return t[r]=o,e.push(r),n},c=function(){for(var n=[],r=0;r<e.length;r++)n.push(t[e[r]]);return n};return r(n).getset("scale").method({reset:o,update:i,mover:s,init:a,add:u,displays:c}),n},a.area=function(){var t,e=a.line(),n=e.line(),r=d3.svg.area().interpolate(n.interpolate()).tension(e.tension()),o=e.create();e.create(function(a){var i=this,s=e.scale();void 0!==t&&i.g.select("path").remove(),o.call(i,a,s),r.x(n.x()).y1(n.y()).y0(i.height()),t=a.data(),a.remove(),i.g.append("path").attr("class","tnt_area").classed("tnt_elem",!0).datum(t).attr("d",r).attr("fill",d3.rgb(e.color()).brighter())});var i=e.move();return e.move(function(o){var a=this,s=e.scale();i.call(a,o,s),r.x(n.x()),a.g.select(".tnt_area").datum(t).attr("d",r)}),e},a.line=function(){var t=a(),e=function(t){return t.pos},n=function(t){return t.val},r=.7,o=d3.scale.linear(),i=d3.svg.line().interpolate("basis");t.line=function(){return i},t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(e){return arguments.length?(n=e,t):n},t.tension=function(e){return arguments.length?(r=e,t):r};var s;return t.create(function(a){var u=this,c=t.scale();void 0!==s&&u.g.select("path").remove(),i.tension(r).x(function(t){return c(e(t))}).y(function(t){return u.height()-o(n(t))}),s=a.data(),a.remove(),o.domain([0,1]).range([0,u.height()-2]),u.g.append("path").attr("class","tnt_elem").attr("d",i(s)).style("stroke",t.color()).style("stroke-width",4).style("fill","none")}),t.move(function(n){var r=this,o=t.scale();i.x(function(t){return o(e(t))}),r.g.select("path").attr("d",i(s))}),t},a.conservation=function(){var t=a.area(),e=t.create();return t.create(function(n){var r=this,o=t.scale();e.call(r,d3.select(n[0][0]),o)}),t},a.ensembl=function(){var t=a(),e="#7FFF00",n="#00BB00";return t.fixed(function(e){var n=this,r=~~(n.height()-.8*n.height())/2;n.g.append("line").attr("class","tnt_guider").attr("x1",0).attr("x2",e).attr("y1",r).attr("y2",r).style("stroke",t.color()).style("stroke-width",1),n.g.append("line").attr("class","tnt_guider").attr("x1",0).attr("x2",e).attr("y1",n.height()-r).attr("y2",n.height()-r).style("stroke",t.color()).style("stroke-width",1)}),t.create(function(e){var n=this,r=t.scale(),o=~~(n.height()-.8*n.height())/2;e.append("rect").attr("x",function(t){return r(t.start)}).attr("y",o).attr("width",function(t){return r(t.end)-r(t.start)}).attr("height",n.height()-~~(2*o)).attr("fill",n.color()).transition().duration(500).attr("fill",function(e){return"high"===e.type?d3.rgb(t.color()):"low"===e.type?d3.rgb(t.color2()):d3.rgb(t.color3())})}),t.distribute(function(e){var n=t.scale();e.select("rect").attr("width",function(t){return n(t.end)-n(t.start)})}),t.move(function(e){var n=t.scale();e.select("rect").attr("x",function(t){return n(t.start)}).attr("width",function(t){return n(t.end)-n(t.start)})}),t.color2=function(n){return arguments.length?(e=n,t):e},t.color3=function(e){return arguments.length?(n=e,t):n},t},a.vline=function(){var t=a();return t.create(function(e){var n=t.scale(),r=this;e.append("line").attr("x1",function(e){return n(t.index()(e))}).attr("x2",function(e){return n(t.index()(e))}).attr("y1",0).attr("y2",r.height()).attr("stroke",t.color()).attr("stroke-width",1)}),t.move(function(e){var n=t.scale();e.select("line").attr("x1",function(e){return n(t.index()(e))}).attr("x2",function(e){return n(t.index()(e))})}),t},a.pin=function(){var t=a(),e=d3.scale.linear().domain([0,0]).range([0,0]),n={pos:d3.functor("pos"),val:d3.functor("val"),domain:[0,0]},o=5;return r(t).getset(n),t.create(function(r){var a=this,i=t.scale();e.domain(t.domain()).range([o,a.height()-o-10]),r.append("line").attr("x1",function(t,e){return i(t[n.pos(t,e)])}).attr("y1",function(t){return a.height()}).attr("x2",function(t,e){return i(t[n.pos(t,e)])}).attr("y2",function(t,r){return a.height()-e(t[n.val(t,r)])}).attr("stroke",function(e){return d3.functor(t.color())(e)}),r.append("circle").attr("cx",function(t,e){return i(t[n.pos(t,e)])}).attr("cy",function(t,r){return a.height()-e(t[n.val(t,r)])}).attr("r",o).attr("fill",function(e){return d3.functor(t.color())(e)}),r.append("text").attr("font-size","13").attr("x",function(t,e){return i(t[n.pos(t,e)])}).attr("y",function(t,e){return 10}).style("text-anchor","middle").text(function(t){return t.label||""})}),t.distribute(function(t){t.select("text").text(function(t){return t.label||""})}),t.move(function(r){var o=this,a=t.scale();r.select("line").attr("x1",function(t,e){return a(t[n.pos(t,e)])}).attr("y1",function(t){return o.height()}).attr("x2",function(t,e){return a(t[n.pos(t,e)])}).attr("y2",function(t,r){return o.height()-e(t[n.val(t,r)])}),r.select("circle").attr("cx",function(t,e){return a(t[n.pos(t,e)])}).attr("cy",function(t,r){return o.height()-e(t[n.val(t,r)])}),r.select("text").attr("x",function(t,e){return a(t[n.pos(t,e)])}).text(function(t){return t.label||""})}),t.fixed(function(t){var e=this;e.g.append("line").attr("x1",0).attr("x2",t).attr("y1",e.height()).attr("y2",e.height()).style("stroke","black").style("stroke-with","1px")}),t},a.block=function(){var t=a();return r(t).getset("from",function(t){return t.start}).getset("to",function(t){return t.end}),t.create(function(e){var n=this,r=t.scale();e.append("rect").attr("x",function(e,n){return r(t.from()(e,n))}).attr("y",0).attr("width",function(e,n){return r(t.to()(e,n))-r(t.from()(e,n))}).attr("height",n.height()).attr("fill",n.color()).transition().duration(500).attr("fill",function(e){return void 0===e.color?t.color():e.color})}),t.distribute(function(e){var n=t.scale();e.select("rect").attr("width",function(t){return n(t.end)-n(t.start)})}),t.move(function(e){var n=t.scale();e.select("rect").attr("x",function(t){return n(t.start)}).attr("width",function(t){return n(t.end)-n(t.start)})}),t},a.axis=function(){var t,e,n="top",r={};return r.reset=function(){t=void 0;var e=this;e.g.selectAll("rect").remove(),e.g.selectAll(".tick").remove()},r.plot=function(){},r.mover=function(){var e=this,n=e.g;n.call(t)},r.init=function(){t=void 0},r.update=function(){void 0===t&&(t=d3.svg.axis().scale(e).orient(n));var r=this,o=r.g;o.call(t)},r.orientation=function(t){return arguments.length?(n=t,this):n},r.scale=function(t){return arguments.length?(e=t,this):e},r},a.location=function(){var t,e,n={};return n.reset=function(){t=void 0},n.plot=function(){},n.init=function(){t=void 0},n.mover=function(){var n=e.domain();t.select("text").text("Location: "+~~n[0]+"-"+~~n[1])},n.scale=function(t){return arguments.length?(e=t,this):e},n.update=function(n){var r=this,o=r.g,a=e.domain();void 0===t&&(t=o,t.append("text").text("Location: "+Math.round(a[0])+"-"+Math.round(a[1])))},n},e.exports=n=a},{"./layout.js":31,"tnt.api":24}],30:[function(t,e,n){var r=t("./board.js");r.track=t("./track"),r.track.data=t("./data.js"),r.track.layout=t("./layout.js"),r.track.feature=t("./feature.js"),r.track.layout=t("./layout.js"),e.exports=n=r},{"./board.js":27,"./data.js":28,"./feature.js":29,"./layout.js":31,"./track":33}],31:[function(t,e,n){var r=t("tnt.api"),o=function(){var t=function(e){var n=this;return t.elements().call(n,e),e};r(t).getset("elements",function(){});return t};o.identity=function(){return o().elements(function(t){return t})},e.exports=n=o},{"tnt.api":24}],32:[function(t,e,n){var r=function(){function t(t,e,n){t.append("rect").attr("x","46.5").attr("y","40").attr("width","7").attr("height","20").attr("rx","5").attr("ry","5").attr("fill",d3.rgb(n).darker(2)).attr("transform","rotate("+30*e+" 50 50) translate(0 -30)").append("animate").attr("attributeName","opacity").attr("from","1").attr("to","0").attr("dur","1s").attr("begin",1/12*e+"s").attr("repeatCount","indefinite")}var e,n={};return n.on=function(){var n=this;if(n.spinner?n.spinner++:n.spinner=1,1==n.spinner){var r=n.g,o=n.color();e=r.append("svg").attr("class","tnt_spinner").attr("width","30px").attr("height","30px").attr("xmls","http://www.w3.org/2000/svg").attr("viewBox","0 0 100 100").attr("preserveAspectRatio","xMidYMid"),e.append("rect").attr("x","0").attr("y","0").attr("width","100").attr("height","100").attr("rx","50").attr("ry","50").attr("fill",o);for(var a=0;12>a;a++)t(e,a,o)}else if(n.spinner>0){var i=e.node();i.parentNode&&i.parentNode.appendChild(i)}},n.off=function(){var t=this;if(t.spinner--,!t.spinner){var e=t.g;e.selectAll(".tnt_spinner").remove()}},n};e.exports=n=r},{}],33:[function(t,e,n){var r=t("tnt.api"),o=t("tnt.utils").iterator,a=function(){"use strict";var t,e={color:d3.rgb("#CCCCCC"),height:250,data:a.data.empty(),label:"",id:a.id()},n={};r(n).getset(e);return n.display=function(n){if(!arguments.length)return t;if(t=n,"function"==typeof t)t.layout&&t.layout().height(e.height);else for(var r in t)t.hasOwnProperty(r)&&t[r].layout&&t[r].layout().height(e.height);return this},n};a.id=o(1),e.exports=n=a},{"tnt.api":24,"tnt.utils":62}],34:[function(t,e,n){e.exports=tnt_rest=t("./src/rest.js")},{"./src/rest.js":51}],35:[function(t,e,n){(function(n,r){(function(){"use strict";function o(t){return"function"==typeof t||"object"==typeof t&&null!==t}function a(t){return"function"==typeof t}function i(t){return"object"==typeof t&&null!==t}function s(t){V=t}function u(t){K=t}function c(){return function(){n.nextTick(h)}}function l(){return function(){U(h)}}function f(){var t=0,e=new Q(h),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function p(){var t=new MessageChannel;return t.port1.onmessage=h,function(){t.port2.postMessage(0)}}function d(){return function(){setTimeout(h,1)}}function h(){for(var t=0;$>t;t+=2){var e=et[t],n=et[t+1];e(n),et[t]=void 0,et[t+1]=void 0}$=0}function v(){try{var e=t,n=e("vertx");return U=n.runOnLoop||n.runOnContext,l()}catch(r){return d()}}function g(){}function m(){return new TypeError("You cannot resolve a promise with itself")}function _(){return new TypeError("A promises callback cannot return that same promise.")}function y(t){try{return t.then}catch(e){return at.error=e,at}}function b(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function w(t,e,n){K(function(t){var r=!1,o=b(n,e,function(n){r||(r=!0,e!==n?A(t,n):T(t,n))},function(e){r||(r=!0,R(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,R(t,o))},t)}function x(t,e){e._state===rt?T(t,e._result):e._state===ot?R(t,e._result):E(e,void 0,function(e){A(t,e)},function(e){R(t,e)})}function k(t,e){if(e.constructor===t.constructor)x(t,e);else{var n=y(e);n===at?R(t,at.error):void 0===n?T(t,e):a(n)?w(t,e,n):T(t,e)}}function A(t,e){t===e?R(t,m()):o(e)?k(t,e):T(t,e)}function j(t){t._onerror&&t._onerror(t._result),O(t)}function T(t,e){t._state===nt&&(t._result=e,t._state=rt,0!==t._subscribers.length&&K(O,t))}function R(t,e){t._state===nt&&(t._state=ot,t._result=e,K(j,t))}function E(t,e,n,r){var o=t._subscribers,a=o.length;t._onerror=null,o[a]=e,o[a+rt]=n,o[a+ot]=r,0===a&&t._state&&K(O,t)}function O(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,o,a=t._result,i=0;i<e.length;i+=3)r=e[i],o=e[i+n],r?q(n,r,o,a):o(a);t._subscribers.length=0}}function P(){this.error=null}function C(t,e){try{return t(e)}catch(n){return it.error=n,it}}function q(t,e,n,r){var o,i,s,u,c=a(n);if(c){if(o=C(n,r),o===it?(u=!0,i=o.error,o=null):s=!0,e===o)return void R(e,_())}else o=r,s=!0;e._state!==nt||(c&&s?A(e,o):u?R(e,i):t===rt?T(e,o):t===ot&&R(e,o))}function S(t,e){try{e(function(e){A(t,e)},function(e){R(t,e)})}catch(n){R(t,n)}}function N(t,e){var n=this;n._instanceConstructor=t,n.promise=new t(g),n._validateInput(e)?(n._input=e,n.length=e.length,n._remaining=e.length,n._init(),0===n.length?T(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&T(n.promise,n._result))):R(n.promise,n._validationError())}function z(t){return new st(this,t).promise}function I(t){function e(t){A(o,t)}function n(t){R(o,t)}var r=this,o=new r(g);if(!Y(t))return R(o,new TypeError("You must pass an array to race.")),o;for(var a=t.length,i=0;o._state===nt&&a>i;i++)E(r.resolve(t[i]),void 0,e,n);return o}function M(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(g);return A(n,t),n}function F(t){var e=this,n=new e(g);return R(n,t),n}function H(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function B(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function L(t){this._id=pt++,this._state=void 0,this._result=void 0,this._subscribers=[],g!==t&&(a(t)||H(),this instanceof L||B(),S(this,t))}function D(){var t;if("undefined"!=typeof r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;(!n||"[object Promise]"!==Object.prototype.toString.call(n.resolve())||n.cast)&&(t.Promise=dt)}var G;G=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var U,V,X,Y=G,$=0,K=({}.toString,function(t,e){et[$]=t,et[$+1]=e,$+=2,2===$&&(V?V(h):X())}),J="undefined"!=typeof window?window:void 0,W=J||{},Q=W.MutationObserver||W.WebKitMutationObserver,Z="undefined"!=typeof n&&"[object process]"==={}.toString.call(n),tt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,et=new Array(1e3);X=Z?c():Q?f():tt?p():void 0===J&&"function"==typeof t?v():d();var nt=void 0,rt=1,ot=2,at=new P,it=new P;N.prototype._validateInput=function(t){return Y(t)},N.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},N.prototype._init=function(){this._result=new Array(this.length)};var st=N;N.prototype._enumerate=function(){for(var t=this,e=t.length,n=t.promise,r=t._input,o=0;n._state===nt&&e>o;o++)t._eachEntry(r[o],o)},N.prototype._eachEntry=function(t,e){var n=this,r=n._instanceConstructor;i(t)?t.constructor===r&&t._state!==nt?(t._onerror=null,n._settledAt(t._state,e,t._result)):n._willSettleAt(r.resolve(t),e):(n._remaining--,n._result[e]=t)},N.prototype._settledAt=function(t,e,n){var r=this,o=r.promise;o._state===nt&&(r._remaining--,t===ot?R(o,n):r._result[e]=n),0===r._remaining&&T(o,r._result)},N.prototype._willSettleAt=function(t,e){var n=this;E(t,void 0,function(t){n._settledAt(rt,e,t)},function(t){n._settledAt(ot,e,t)})};var ut=z,ct=I,lt=M,ft=F,pt=0,dt=L;L.all=ut,L.race=ct,L.resolve=lt,L.reject=ft,L._setScheduler=s,L._setAsap=u,L._asap=K,L.prototype={constructor:L,then:function(t,e){var n=this,r=n._state;if(r===rt&&!t||r===ot&&!e)return this;var o=new this.constructor(g),a=n._result;if(r){var i=arguments[r-1];K(function(){q(r,o,i,a)})}else E(n,o,t,e);return o},"catch":function(t){return this.then(null,t)}};var ht=D,vt={Promise:dt,polyfill:ht};"function"==typeof define&&define.amd?define(function(){return vt}):"undefined"!=typeof e&&e.exports?e.exports=vt:"undefined"!=typeof this&&(this.ES6Promise=vt),ht()}).call(this)}).call(this,t("IrXUsu"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{IrXUsu:19}],36:[function(t,e,n){e.exports=t(5)},{}],37:[function(t,e,n){e.exports=t(6)},{"./response":40}],38:[function(t,e,n){e.exports=t(7)},{"../plugins/cleanurl":45,"./error":37,"./request":39,"./response":40,"./utils/delay":41,"./utils/once":42,"./xhr":43,xtend:44}],39:[function(t,e,n){e.exports=t(8)},{}],40:[function(t,e,n){e.exports=t(9)},{"./request":39}],41:[function(t,e,n){e.exports=t(10)},{}],42:[function(t,e,n){e.exports=t(11)},{}],43:[function(t,e,n){e.exports=t(12)},{}],44:[function(t,e,n){e.exports=t(13)},{}],45:[function(t,e,n){e.exports=t(14)},{}],46:[function(t,e,n){e.exports=t(15)},{"./jsonrequest":47,"./jsonresponse":48}],47:[function(t,e,n){e.exports=t(16)},{}],48:[function(t,e,n){e.exports=t(17)},{}],49:[function(t,e,n){e.exports=t(21)},{"./src/api.js":50}],50:[function(t,e,n){e.exports=t(22)},{}],51:[function(t,e,n){var r=t("httpplease"),o=t("tnt.api"),a=t("httpplease-promises"),i=t("es6-promise").Promise,s=t("httpplease/plugins/json");r=r.use(s).use(a(i)),tnt_rest=function(){var e={prefix:"",protocol:"http",domain:"",port:""},n={};n.url=t("./url.js");var a=o(n).getset(e);return a.method("call",function(t,n){var o;return"string"==typeof t?o=t:(t._prefix(e.prefix)._protocol(e.protocol)._domain(e.domain)._port(e.port),o=t()),n?r.post({url:o,body:n}):r.get({url:o})}),n},e.exports=n=tnt_rest},{"./url.js":52,"es6-promise":35,httpplease:38,"httpplease-promises":36,"httpplease/plugins/json":46,"tnt.api":49}],52:[function(t,e,n){var r=t("tnt.api"),o=function(){function t(e){var n=a.parameters[e];if(!Array.isArray(n))return n;var r=n.shift();return n.length?r+"&"+e+"="+t(e):r}function e(){void 0===a.parameters["content-type"]&&(a.parameters["content-type"]="application/json");var e=Object.keys(a.parameters).map(function(e){return e+"="+t(e)}).join("&");return e?"?"+e:e}function n(){var t=a.endpoint,n=t.replace(o,function(t){t=t.substring(1,t.length);var e=a.parameters[t]||"";return delete a.parameters[t],e}),r=a._prefix+a._protocol+"://"+a._domain+(a._port?":"+port:"")+"/"+n+e()+(a.fragment?"#"+a.fragment:"");return r}var o=/:\w+/g,a={_prefix:"",_protocol:"http",_domain:"",_port:"",endpoint:"",parameters:{},fragment:"",rest:void 0},i=function(){return n()};r(i).getset(a);return i};e.exports=n=o},{"tnt.api":49}],53:[function(t,e,n){var r=t("tnt.board"),o=t("tnt.api"),a=function(){var t=r.track.data.genome.ensembl,e=r.track.data.async().retriever(function(e){var n=t.url().endpoint("overlap/region/:species/:region").parameters({species:e.species,region:e.chr+":"+e.from+"-"+e.to,feature:e.features||["gene"]});return t.call(n).then(function(t){for(var e=t.body,n=0;n<e.length;n++){var r=e[n];-1===r.strand?r.display_label="<"+r.external_name:r.display_label=r.external_name+">"}return e})});return o(e).getset("ensembl"),e},i=function(){function t(t){for(var e=t.exons,n=[],r=0;r<e.length-1;r++){var o={start:1===e[r].transcript.strand?e[r].end:e[r].start,end:1===e[r].transcript.strand?e[r+1].start:e[r+1].end,transcript:t};n.push(o)}return n}function e(t){var e,n;void 0!==t.Translation&&(e=t.Translation.start,n=t.Translation.end);var r=t.Exon,o=[];if(r)for(var a=0;a<r.length;a++)if(void 0===t.Translation)o.push({start:r[a].start,end:r[a].end,transcript:t,coding:!1,offset:r[a].start-t.start});else if(r[a].start<e)if(r[a].end<e)o.push({start:r[a].start,end:r[a].end,transcript:t,coding:!1,offset:r[a].start-t.start});else{var i={start:r[a].start,end:e,transcript:t,coding:!1,offset:r[a].start-t.start},s={start:e,end:r[a].end,transcript:t,coding:!0,offset:e-t.start};1===r[a].strand?(o.push(i),o.push(s)):(o.push(s),o.push(i))}else if(r[a].end>n)if(r[a].start>n)o.push({start:r[a].start,end:r[a].end,transcript:t,coding:!1,offset:r[a].start-t.start});else{var u={start:r[a].start,end:n,transcript:t,coding:!0,offset:r[a].start-t.start},c={start:n,end:r[a].end,transcript:t,coding:!1,offset:n-t.start};1===r[a].strand?(o.push(u),o.push(c)):(o.push(c),o.push(u))}else o.push({start:r[a].start,end:r[a].end,transcript:t,coding:!0,offset:r[a].start-t.start});return o}var n=r.track.data.genome.ensembl,a=r.track.data.async().retriever(function(t){var e=n.url().endpoint("overlap/region/:species/:region").parameters({species:t.species,region:t.chr+":"+t.from+"-"+t.to,feature:["gene","transcript","exon","cds"]});return n.call(e).then(function(t){for(var e=t.body,n=a.region2genes(e),r=[],o=0;o<n.length;o++){var i=n[o],s=a.gene2Transcripts(i);r=r.concat(s)}return r})});return o(a).method("gene2Transcripts",function(n){for(var r=n.Transcript,o=[],a=0;a<r.length;a++){var i=r[a];i.exons=e(i),i.introns=t(i),i.display_label=1===i.strand?i.display_name+">":"<"+i.display_name,i.key=i.id+"_"+i.exons.length,i.gene=n,o.push(i)}return o}).method("region2genes",function(t){for(var e={},n=[],r={},o=0;o<t.length;o++){var a=t[o];"transcript"==a.feature_type&&(a.display_name=a.external_name,r[a.id]=a,void 0===e[a.Parent]&&(e[a.Parent]=[]),e[a.Parent].push(a))}for(var i=0;i<t.length;i++){var a=t[i];if("exon"===a.feature_type){var s=r[a.Parent];void 0===s.Exon&&(s.Exon=[]),s.Exon.push(a)}}for(var u=0;u<t.length;u++){var a=t[u];if("cds"===a.feature_type){var s=r[a.Parent];void 0===s.Translation&&(s.Translation=a),a.start<s.Translation.start&&(s.Translation.start=a.start),a.end>s.Translation.end&&(s.Translation.end=a.end)}}for(var c=0;c<t.length;c++){var a=t[c];"gene"===a.feature_type&&(a.display_name=a.external_name,a.Transcript=e[a.id],n.push(a))}return n}),a},s=function(){var t=r.track.data.genome.ensembl,e=r.track.data.async().retriever(function(n){if(n.to-n.from<e.limit()){var r=t.url().endpoint("/sequence/region/:species/:region").parameters({species:n.species,region:n.chr+":"+n.from+".."+n.to});return t.call(r).then(function(t){for(var e=t.body,n=e.id.split(":"),r=n[3],o=[],a=0;a<e.seq.length;a++)o.push({pos:+r+a,sequence:e.seq[a]});return o})}return new Promise(function(t,e){t([])})});return o(e).getset("limit",150),e},u={gene:a,sequence:s,transcript:i};e.exports=n=u},{"tnt.api":24,"tnt.board":26}],54:[function(t,e,n){var r=t("tnt.api"),o=(t("./layout.js"),t("tnt.board")),a=function(){var t=o.track.feature().layout(o.track.layout.genome()).index(function(t){return t.key});return t.create(function(e){var n=this,r=t.scale(),o=e.append("g").attr("transform",function(e){return"translate("+r(e.start)+","+t.layout().gene_slot().slot_height*e.slot+")"});o.append("line").attr("x1",0).attr("y1",~~(t.layout().gene_slot().gene_height/2)).attr("x2",function(t){return r(t.end)-r(t.start)}).attr("y2",~~(t.layout().gene_slot().gene_height/2)).attr("fill","none").attr("stroke",n.color()).attr("stroke-width",2).transition().duration(500).attr("stroke",function(e){return t.color()(e)}),e.each(function(t){if(t.exons)for(var e=0;e<t.exons.length;e++)t.exons[e].slot=t.slot});var a=o.selectAll(".exons").data(function(t){return t.exons||[]},function(t){return t.start});a.enter().append("rect").attr("class","tnt_exons").attr("x",function(t){return r(t.start+t.offset)-r(t.start)}).attr("y",0).attr("width",function(t){return r(t.end)-r(t.start)}).attr("height",t.layout().gene_slot().gene_height).attr("fill",n.color()).attr("stroke",n.color()).transition().duration(500).attr("stroke",function(e){return t.color()(e)}).attr("fill",function(e){return e.coding?t.color()(e):e.coding===!1?n.color():t.color()(e)}),o.append("text").attr("class","tnt_name").attr("x",0).attr("y",25).attr("fill",n.color()).text(function(e){return t.layout().gene_slot().show_label?e.display_label:""}).style("font-weight","normal").transition().duration(500).attr("fill",function(e){return t.color()(e)})}),t.distribute(function(e){var n=t.scale(),r=e.select("g").transition().duration(200).attr("transform",function(e){return"translate("+n(e.start)+","+t.layout().gene_slot().slot_height*e.slot+")"});r.selectAll("rect").attr("height",t.layout().gene_slot().gene_height),r.selectAll("line").attr("x2",function(t){return n(t.end)-n(t.start)}).attr("y1",~~(t.layout().gene_slot().gene_height/2)).attr("y2",~~(t.layout().gene_slot().gene_height/2)),r.select("text").text(function(e){return t.layout().gene_slot().show_label?e.display_label:""})}),t.move(function(e){var n=t.scale(),r=e.select("g").attr("transform",function(e){return"translate("+n(e.start)+","+t.layout().gene_slot().slot_height*e.slot+")"});r.selectAll("line").attr("x2",function(t){return n(t.end)-n(t.start)}).attr("y1",~~(t.layout().gene_slot().gene_height/2)).attr("y2",~~(t.layout().gene_slot().gene_height/2)),r.selectAll("rect").attr("width",function(t){return n(t.end)-n(t.start)}),r.selectAll(".tnt_exons").attr("x",function(t){return n(t.start+t.offset)-n(t.start)})}),t},i=function(){var t={fontsize:10,sequence:function(t){return t.sequence}},e=o.track.feature().index(function(t){return t.pos});r(e).getset(t);return e.create(function(n){var r=this,o=e.scale();n.append("text").attr("fill",r.color()).style("font-size",t.fontsize+"px").attr("x",function(e){return o(e.pos)-t.fontsize/2+1}).attr("y",function(t){return~~(r.height()/2)+5}).style("font-family",'"Lucida Console", Monaco, monospace').text(t.sequence).transition().duration(500).attr("fill",e.color())}),e.move(function(n){var r=e.scale();n.select("text").attr("x",function(e){return r(e.pos)-t.fontsize/2+1})}),e},s=function(){var t=o.track.feature().layout(o.track.layout.genome()).index(function(t){return t.id});return t.create(function(e){var n=this,r=t.scale();e.append("rect").attr("x",function(t){return r(t.start)}).attr("y",function(e){return t.layout().gene_slot().slot_height*e.slot}).attr("width",function(t){return r(t.end)-r(t.start)}).attr("height",t.layout().gene_slot().gene_height).attr("fill",n.color()).transition().duration(500).attr("fill",function(e){return void 0===e.color?t.color():e.color}),e.append("text").attr("class","tnt_name").attr("x",function(t){return r(t.start)}).attr("y",function(e){return t.layout().gene_slot().slot_height*e.slot+25}).attr("fill",n.color()).text(function(e){return t.layout().gene_slot().show_label?e.display_label:""}).style("font-weight","normal").transition().duration(500).attr("fill",function(){return t.color()})}),t.distribute(function(e){e.select("rect").transition().duration(500).attr("y",function(e){return t.layout().gene_slot().slot_height*e.slot}).attr("height",t.layout().gene_slot().gene_height),e.select("text").transition().duration(500).attr("y",function(e){return t.layout().gene_slot().slot_height*e.slot+25}).text(function(e){return t.layout().gene_slot().show_label?e.display_label:"";
})}),t.move(function(e){var n=t.scale();e.select("rect").attr("x",function(t){return n(t.start)}).attr("width",function(t){return n(t.end)-n(t.start)}),e.select("text").attr("x",function(t){return n(t.start)})}),t},u=function(){var t,e,n,r,o=function(t,e,n,r){return t+" "+e+":"+n+"-"+r},a={};return a.reset=function(){},a.plot=function(){},a.init=function(){e=void 0},a.mover=function(){var t=a.scale(),i=t.domain();e.select("text").text(o(r,n,~~i[0],~~i[1]))},a.update=function(a){n=a.chr,r=a.species;var i=this,s=i.g,u=t.domain();void 0===e&&(e=s,e.append("text").text(o(r,n,~~u[0],~~u[1])))},a.scale=function(e){return arguments.length?(t=e,this):t},a.text=function(t){return arguments.length?(o=t,this):o},a},c={gene:s,sequence:i,transcript:a,location:u};e.exports=n=c},{"./layout.js":57,"tnt.api":24,"tnt.board":26}],55:[function(t,e,n){var r=t("tnt.api"),o=t("tnt.board");o.track.data.genome=t("./data.js"),o.track.feature.genome=t("./feature"),o.track.layout.genome=t("./layout"),o.track.data.genome.ensembl=t("tnt.rest")().domain("rest.ensembl.org"),tnt_board_genome=function(){"use strict";var t=o.track.data.genome.ensembl,e=/^ENS\w+\d+$/,n={gene:void 0,xref_search:function(){},ensgene_search:function(){},context:0,rest:t},a=o().zoom_in(200).zoom_out(5e6).min(0),i=o.track().height(20).color("white").data(o.track.data.empty()).display(o.track.feature.genome.location()),s=o.track().height(0).color("white").data(o.track.data.empty()).display(o.track.feature.axis());a.add_track(i).add_track(s),a.species("human").chr(7).from(139424940).to(141784100),a._start=a.start;var u=function(e){if(void 0!==e){if(void 0!==e.gene)return void f(e);void 0===e.species?e.species=a.species():a.species(e.species),void 0===e.chr?e.chr=a.chr():a.chr(e.chr),void 0===e.from?e.from=a.from():a.from(e.from),void 0===e.to?e.to=a.to():a.to(e.to)}else{if(void 0!==a.gene())return void f({species:a.species(),gene:a.gene()});e={},e.species=a.species(),e.chr=a.chr(),e.from=a.from(),e.to=a.to()}var n=t.url().endpoint("info/assembly/:species/:region_name").parameters({species:e.species,region_name:e.chr});t.call(n).then(function(t){a.max(t.body.length),a._start()})},c=function(e,n){var r=t.url.homologues({id:e});t.call(r).then(function(t){var e=t.body.data[0].homologies;if(void 0!==n){var r=d(e);n(r)}})},l=function(t){return t.match(e)?!0:!1},f=function(e){if(l(e.gene))p(e.gene);else{var r=t.url().endpoint("xrefs/symbol/:species/:symbol").parameters({species:e.species,symbol:e.gene});t.call(r).then(function(t){var r=t.body;r=r.filter(function(t){return!t.id.indexOf("ENS")}),void 0!==r[0]&&p(r[0].id),n.xref_search(t,e.gene,e.species)})}},p=function(e){var r=t.url().endpoint("/lookup/id/:id").parameters({id:e});t.call(r).then(function(t){var e=t.body;n.ensgene_search(e);var r=~~((e.end-e.start)*(n.context/100));a.species(e.species).chr(e.seq_region_name).from(e.start-r).to(e.end+r),a.start({species:e.species,chr:e.seq_region_name,from:e.start-r,to:e.end+r})})},d=function(t){var e=/ortholog/,n=/paralog/,r=t.filter(function(t){return t.type.match(e)}),o=t.filter(function(t){return t.type.match(n)});return{orthologues:r,paralogues:o}},h=r(a).getset(n);return h.method({start:u,homologues:c}),a},e.exports=n=tnt_board_genome},{"./data.js":53,"./feature":54,"./layout":57,"tnt.api":24,"tnt.board":26,"tnt.rest":34}],56:[function(t,e,n){var r=t("tnt.board");r.genome=t("./genome"),e.exports=n=r},{"./genome":55,"tnt.board":26}],57:[function(t,e,n){var r=t("tnt.api"),o=function(){var t,e,n=[],o={expanded:{slot_height:30,gene_height:10,show_label:!0},collapsed:{slot_height:10,gene_height:7,show_label:!1}},a="expanded",i=function(r){var s=this;e=s.display().scale();for(var c=0;c<r.length;c++)null===r[c].external_name&&(r[c].external_name="");t=~~(s.height()/o.expanded.slot_height),i.keep_slots()&&l(r,n);var f=u(r);return o.collapsed.needed_slots=f,o.expanded.needed_slots=f,a=i.fixed_slot_type()?i.fixed_slot_type():f>t?"collapsed":"expanded",i.on_layout_run()(o,a),n=r,r},s=function(){return o[a]},u=function(e){for(var n=[],r=e,o=0,a=0;a<e.length;a++)e[a].slot>o&&e[a].slot<t&&(o=e[a].slot);for(var i=0;i<r.length;i++){var s=p(n),u=r[i];if(void 0!==u.slot&&u.slot<t&&c(u,s[u.slot]))n.push(u);else for(var l=0;;){if(c(u,s[l])){u.slot=l,n.push(u),l>o&&(o=l);break}l++}}return o+1},c=function(t,n){if(void 0===n)return!0;for(var r=0;r<n.length;r++){var o=n[r];if(t.id!==o.id){var a=8*o.display_label.length+e(o.start),i=e(o.start),s=e(o.end)>a?e(o.end):a,u=8*t.display_label.length+e(t.start),c=e(t.start),l=e(t.end)>u?e(t.end):u;if(i>=c&&l>=i||c>=i&&s>=c)return!1}}return!0},l=function(t,e){for(var n=f(e),r=0;r<t.length;r++)void 0!==n[t[r].id]&&(t[r].slot=n[t[r].id])},f=function(t){for(var e={},n=0;n<t.length;n++){var r=t[n];e[r.id]=r.slot}return e},p=function(t){for(var e=[],n=0;n<t.length;n++)void 0===e[t[n].slot]&&(e[t[n].slot]=[]),e[t[n].slot].push(t[n]);return e};r(i).getset("elements",function(){}).getset("on_layout_run",function(){}).getset("fixed_slot_type").getset("keep_slots",!0).method({gene_slot:s});return i.fixed_slot_type.check(function(t){return"collapsed"===t||"expanded"===t}),i};e.exports=n=o},{"tnt.api":24}],58:[function(t,e,n){e.exports=tooltip=t("./src/tooltip.js")},{"./src/tooltip.js":61}],59:[function(t,e,n){e.exports=t(21)},{"./src/api.js":60}],60:[function(t,e,n){e.exports=t(22)},{}],61:[function(t,e,n){var r=t("tnt.api"),o=function(){"use strict";function t(e,n){if(n=n.toLowerCase(),null===e.parentNode)return void console.log("No more parents");var r=e.parentNode.tagName;return void 0!==r&&r.toLowerCase()===n?e.parentNode:t(e.parentNode,n)}var e,n=d3.behavior.drag(),o={position:"right",allow_drag:!0,show_closer:!0,fill:function(){throw"fill is not defined in the base object"},width:180,id:1},a=function(r,i){n.origin(function(){return{x:parseInt(d3.select(this).style("left")),y:parseInt(d3.select(this).style("top"))}}).on("drag",function(){o.allow_drag&&d3.select(this).style("left",d3.event.x+"px").style("top",d3.event.y+"px")});var s=t(this,"div");if(void 0!==s){e=d3.select(s).append("div").attr("class","tnt_tooltip").classed("tnt_tooltip_active",!0).call(n),d3.select("#tnt_tooltip_"+o.id).remove(),null===d3.event&&i&&(d3.event=i);var u=d3.mouse(s);d3.event=null;var c=0;return"left"===o.position&&(c=o.width),e.attr("id","tnt_tooltip_"+o.id),e.style("left",u[0]-c+"px").style("top",u[1]+"px"),o.show_closer&&e.append("div").attr("class","tnt_tooltip_closer").on("click",function(){a.close()}),o.fill.call(e.node(),r),a}},i=r(a).getset(o);return i.check("position",function(t){return"left"===t||"right"===t},"Only 'left' or 'right' values are allowed for position"),i.method("close",function(){e&&e.remove()}),a};o.list=function(){var t=o();return t.fill(function(e){var n=d3.select(this),r=n.append("table").attr("class","tnt_zmenu").attr("border","solid").style("width",t.width()+"px");e.header&&r.append("tr").attr("class","tnt_zmenu_header").append("th").text(e.header);var o=r.selectAll(".tnt_zmenu_row").data(e.rows).enter().append("tr").attr("class","tnt_zmenu_row");o.append("td").style("text-align","center").html(function(t,n){return e.rows[n].value}).each(function(e){void 0!==e.link&&d3.select(this).classed("link",1).on("click",function(e){e.link(e.obj),t.close.call(this)})})}),t},o.table=function(){var t=o();return t.fill(function(e){var n=d3.select(this),r=n.append("table").attr("class","tnt_zmenu").attr("border","solid").style("width",t.width()+"px");e.header&&r.append("tr").attr("class","tnt_zmenu_header").append("th").attr("colspan",2).text(e.header);var o=r.selectAll(".tnt_zmenu_row").data(e.rows).enter().append("tr").attr("class","tnt_zmenu_row");o.append("th").attr("colspan",function(t,e){return""===t.value?2:1}).attr("class",function(t){return""===t.value?"tnt_zmenu_inner_header":"tnt_zmenu_cell"}).html(function(t,n){return e.rows[n].label}),o.append("td").html(function(t,n){return"function"!=typeof e.rows[n].value?e.rows[n].value:void e.rows[n].value.call(this,t)}).each(function(t){""===t.value&&d3.select(this).remove()}).each(function(e){void 0!==e.link&&d3.select(this).classed("link",1).on("click",function(e){e.link(e.obj),t.close.call(this)})})}),t},o.plain=function(){var t=o();return t.fill(function(e){var n=d3.select(this),r=n.append("table").attr("class","tnt_zmenu").attr("border","solid").style("width",t.width()+"px");e.header&&r.append("tr").attr("class","tnt_zmenu_header").append("th").text(e.header),e.body&&r.append("tr").attr("class","tnt_zmenu_row").append("td").style("text-align","center").html(e.body)}),t},e.exports=n=o},{"tnt.api":59}],62:[function(t,e,n){e.exports=t("./src/index.js")},{"./src/index.js":63}],63:[function(t,e,n){var r=t("./utils.js");r.reduce=t("./reduce.js"),e.exports=n=r},{"./reduce.js":64,"./utils.js":65}],64:[function(t,e,n){var r=function(){var t=5,e="val",n=function(t,e){return e>t?.2*e>=e-t:.2*t>=t-e},r=function(t){return t},o=function(t){if(!t.length)return t;var e=s(t),n=r(e);return n},a=function(t,n){if(n.sort(function(t,n){return t[e]-n[e]}),n.length%2)t[e]=n[~~(n.length/2)][e];else{var r=~~(n.length/2)-1;t[e]=(n[r][e]+n[r+1][e])/2}return t},i=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},s=function(e){if(0===t)return e;for(var n=[],r=0;r<e.length;r++){var o=t>r?0:r-t,s=r>e.length-t?e.length:r+t;n[r]=a(i(e[r]),e.slice(o,s+1))}return n};return o.reducer=function(t){return arguments.length?(r=t,o):r},o.redundant=function(t){return arguments.length?(n=t,o):n},o.value=function(t){return arguments.length?(e=t,o):e},o.smooth=function(e){return arguments.length?(t=e,o):t},o},o=function(){var t=r().value("start"),e="end",n=function(n,r){return{object:{start:n.object[t.value()],end:r[e]},value:r[e]}};return t.reducer(function(r){for(var o=t.value(),a=t.redundant(),i=[],s={object:r[0],value:r[0][e]},u=1;u<r.length;u++)a(r[u][o],s.value)?s=n(s,r[u]):(i.push(s.object),s.object=r[u],s.value=r[u].end);return i.push(s.object),i}),r.join=function(e){return arguments.length?(n=e,t):n},r.value2=function(n){return arguments.length?(e=n,t):e},t},a=function(){var t=r();return t.reducer(function(e){for(var n=t.redundant(),r=t.value(),o=[],a=e[0],i=1;i<e.length-1;i++)n(e[i][r],a[r])||(o.push(a),a=e[i]);return o.push(a),o.push(e[e.length-1]),o}),t};e.exports=r,e.exports.line=a,e.exports.block=o},{}],65:[function(t,e,n){e.exports={iterator:function(t){var e=t||0,n=function(){return e++};return n},script_path:function(t){var e=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),n=new RegExp(e+"$"),r=new RegExp("(.*)"+e+"$"),o=document.getElementsByTagName("script"),a="";if(void 0!==o)for(var i in o)if(o[i].src&&o[i].src.match(n))return o[i].src.replace(r,"$1");return a},defer_cancel:function(t,e){var n,r=function(){var r=Array.prototype.slice.call(arguments),o=this;clearTimeout(n),n=setTimeout(function(){t.apply(o,r)},e)};return r}}},{}],66:[function(t,e,n){function r(t,e){var n=5;t.map(function(t){t.label="",t._px=e(t.pos)}),t.sort(function(t,e){return t.pos-e.pos});for(var r=[],o=[t[0]],a=t[0],i=1;i<t.length;i++)t[i]._px-a._px<n?(o.push(t[i]),a=t[i]):(r.push(o),o=[t[i]],a=t[i]);r.push(o);for(var s=0;s<r.length;s++)if(r[s].length>1){var u=r[s][~~(r[s].length/2)];u.label=r[s].length}}e.exports=n=r},{}],67:[function(t,e,n){var r={"protein coding":d3.rgb("#A00000"),pseudogene:d3.rgb("#666666"),"processed transcript":d3.rgb("#0033FF"),ncRNA:d3.rgb("#8B668B"),antisense:d3.rgb("#CBDD8B"),"TR gene":d3.rgb("#AA00AA"),"non coding transcript":d3.rgb("#8B668B")},o={protein_coding:"protein coding",pseudogene:"pseudogene",processed_pseudogene:"pseudogene",transcribed_processed_pseudogene:"pseudogene",unprocessed_pseudogene:"pseudogene",polymorphic_pseudogene:"pseudogene",unitary_pseudogene:"pseudogene",transcribed_unprocessed_pseudogene:"pseudogene",TR_V_pseudogene:"pseudogene",processed_transcript:"processed transcript",TEC:"processed transcript",sense_overlapping:"processed transcript",miRNA:"ncRNA",lincRNA:"ncRNA",misc_RNA:"ncRNA",snoRNA:"ncRNA",snRNA:"ncRNA",rRNA:"ncRNA",antisense:"antisense",sense_intronic:"antisense",TR_V_gene:"TR gene",TR_C_gene:"TR gene",TR_J_gene:"TR gene",TR_D_gene:"TR gene",retained_intron:"non coding transcript",nonsense_mediated_decay:"protein coding"};e.exports=n={color:r,legend:o}},{}],68:[function(t,e,n){var r=function(){"use strict";var t,e,n=!0,r=!0,o="",a="#586471",i=function(r,o){e=r;var a=d3.select(o).append("div").attr("class","tnt_nav_wrapper"),s=a.append("div").attr("class","tnt_nav_pane").style("display",function(){return n?"inline-block":"none"});s.append("span").text("Human Chr: "+r.chr());s.append("i").attr("title","go left").attr("class","cttvGenomeBrowserIcon fa fa-arrow-circle-left fa-2x").on("click",i.left),s.append("i").attr("title","zoom out").attr("class","cttvGenomeBrowserIcon fa fa-search-plus fa-2x").on("click",i.zoomOut),s.append("i").attr("title","zoom in").attr("class","cttvGenomeBrowserIcon fa fa-search-minus fa-2x").on("click",i.zoomIn),s.append("i").attr("title","go right").attr("class","cttvGenomeBrowserIcon fa fa-arrow-circle-right fa-2x").on("click",i.right),s.append("i").attr("title","reload location").attr("class","cttvGenomeBrowserIcon fa fa-refresh fa-lt").on("click",function(){e.start(t)});t||(t=void 0!==e.gene()?{species:e.species(),gene:e.gene()}:{species:e.species(),chr:e.chr(),from:e.from(),to:e.to()})};return i.left=function(){e.move_left(1.5)},i.right=function(){e.move_right(1.5)},i.zoomIn=function(){e.zoom(.5)},i.zoomOut=function(){e.zoom(1.5)},i.show_options=function(t){return n=t,this},i.show_title=function(t){return r=t,this},i.title=function(t){return arguments.length?(o=t,this):o},i.foreground_color=function(t){return arguments.length?(a=t,this):a},i.orig=function(e){return arguments.length?(t=e,this):t},i};e.exports=n=r},{}],69:[function(t,e,n){var r=function(){function t(t,e,n){var r={target:[t],size:1e3,datasource:e,fields:["target.gene_info","disease.efo_info","variant","evidence","type"]};return void 0!==n&&(r.disease=[n],r.expandefo=!1),r}var e={ensembl:void 0,cttv:void 0},n={},r={},o={};o.rare=function(n,r){var c,f;return r?(c=t(n,["uniprot","eva"],r),f=e.cttv.url.filterby(),e.cttv.call(f,void 0,c).then(function(t){return a(t),o.rare(n)})):(c=t(n,["uniprot","eva"]),f=e.cttv.url.filterby(),e.cttv.call(f,void 0,c).then(i).then(l).then(s).then(u))},o.common=function(n,r){var i,s;return r?(i=t(n,["gwas_catalog"],r),s=e.cttv.url.filterby(),e.cttv.call(s,void 0,i).then(function(t){return a(t),o.common(n)})):(i=t(n,["gwas_catalog"]),s=e.cttv.url.filterby(),e.cttv.call(s,void 0,i).then(f).then(l).then(c).then(u))};var a=function(t){for(var e=0;e<t.body.data.length;e++){var n=t.body.data[e],o=n.variant.id[0].split("/").pop();r[o]=1}},i=function(t){for(var e=0;e<t.body.data.length;e++){var o=t.body.data[e];if("genetic_association"===o.type){var a,i=o.variant.id[0],s=i.split("/").pop(),u=o.evidence.gene2variant.provenance_type.database;u.dbxref&&(a=u.dbxref.url.split("/").pop());var c=o.disease.efo_info,l=o.target.gene_info,f=[];o.evidence.variant2disease.provenance_type.literature&&(f=o.evidence.variant2disease.provenance_type.literature.references.map(function(t){return t.lit_id.split("/").pop()})),void 0===n[s]&&(n[s]={},n[s].target=l,n[s].name=s,n[s].efo=[],n[s].associations=[],n[s].clinvarId=a),r[s]&&(n[s].highlight=!0);var p={efo:c.efo_id,label:c.label,name:s,target:l.symbol,pmids:f};n[s].associations.push(p),n[s].efo.push(c.efo_id)}else console.error(o)}var d=Object.keys(n);return d},s=function(t){for(var e in t.body){var r=t.body[e],o=n[e];o.pos=r.mappings[0].start,o.val=1}return n},u=function(t){var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(t[r]);var o=d3.extent(e,function(t){return t.pos});return{extent:o,snps:n}},c=function(t){var e=function(t){for(var e=1/0,n=t.length;n--;){var r=+t[n].pvalue;e>r&&(e=r)}return e};for(var r in t.body)if(t.body.hasOwnProperty(r)){var o=t.body[r],a=n[r];a.pos=o.mappings[0].start,a.val=1-e(a.study)}return n},l=function(t){var n=e.ensembl.url().endpoint("/variation/:species").parameters({species:"human"});return t.length?e.ensembl.call(n,{ids:t}):new Promise(function(t,e){t({body:{}})})},f=function(t){for(var e=0;e<t.body.data.length;e++){var o=t.body.data[e],a=o.variant.id[0],i=o.disease.efo_info,s=a.split("/").pop(),u=o.target.gene_info;void 0===n[s]&&(n[s]={},n[s].target=u,n[s].study=[],n[s].name=s,n[s].efo=[]),r[s]&&(n[s].highlight=!0),n[s].efo.push(i.efo_id),n[s].study.push({pmid:o.evidence.variant2disease.provenance_type.literature.references[0].lit_id,pvalue:o.evidence.variant2disease.resource_score.value,efo:i.efo_id,efo_label:i.label})}var c=Object.keys(n);return c};return o.ensemblRestApi=function(t){return arguments.length?(e.ensembl=t,this):e.ensembl},o.cttvRestApi=function(t){return arguments.length?(e.cttv=t,this):e.cttv},o};e.exports=n=r},{}],70:[function(t,e,n){var r=t("./navigation.js"),o=t("./tooltips.js"),a=t("./aggregation.js"),i=t("rsvp"),s=t("tnt.api"),u=t("./biotypes.js"),c=t("cttv.api"),l=t("./pipelines.js"),f=function(){"use strict";function t(t){var e=t.biotype,n=u.color[u.legend[e]];t.featureColor=n;for(var r=0;r<t.exons.length;r++)t.exons[r].featureColor=n}var e,n,f,p,d,h,v={links_prefix:"https://www.targetvalidation.org",show_links:!0,show_snps:!0,show_nav:!0,cttvRestApi:c().prefix("https://www.targetvalidation.org/api/latest/"),efo:void 0},g={},m=r(),_={TargetDisease:"#FF0000",Target:"#3e9999",Disease:"#FFD400",Other:"#cccccc"},y=0,b=function(e,r){k(r),h=e,e.zoom_in(150),p=tnt.board.track.data.genome.ensembl,m.show_options(v.show_nav);var s=o().cttvRestApi(v.cttvRestApi).ensemblRestApi(p).prefix(v.links_prefix).view(e),c=tnt.board.track.data.genome.gene(),d=c.retriever();c.retriever(function(n){return d(n).then(function(r){for(var o=[],a=0;a<r.length;a++){var i=r[a];i.id!==e.gene()&&(i.key=i.id,i.isGene=!0,i.exons=[{start:i.start,end:i.end,coding:!0,offset:0,isGene:!0}],o.push(i))}var s=p.url().endpoint("/lookup/id/:id").parameters({id:e.gene(),expand:!0});return p.call(s).then(function(e){for(var r=e.body,a=tnt.board.track.data.genome.transcript().gene2Transcripts(r),i=0;i<a.length;i++){var s=a[i];w([n.from,n.to],[s.start,s.end])&&o.push(s)}return o.map(t),x(o),o})})});var w=function(t,e){return t[0]<e[0]&&t[1]>e[1]?!0:t[0]>e[0]&&t[1]<e[1]?!0:t[0]>e[0]&&t[1]>e[1]?!0:t[1]>e[0]&&t[1]<e[1]?!0:!1},x=function(t){var n=t.map(function(t){return u.legend[t.biotype]}),r=t.filter(function(t){return t.gene?t.gene.id===e.gene():t.id===e.gene()}).map(function(t){return u.legend[t.biotype]});n=n.concat(r);for(var o={},a=0;a<n.length;a++)o[n[a]]=1;var i=[];for(var s in o)o.hasOwnProperty(s)&&i.push(s);var c=I.selectAll(".tnt_biotype_legend").data(i,function(t){return t}),l=c.enter().append("div").attr("class","tnt_biotype_legend").style("display","inline");l.append("div").style("display","inline-block").style("margin","0px 5px 0px 15px").style("width","10px").style("height","10px").style("border","1px solid #000").style("background",function(t){return u.color[t]}),l.append("text").text(function(t){return t}),c.exit().remove()},j=function(t){var e=p.url().endpoint("overlap/region/:species/:region").parameters({species:t.species,region:t.chr+":"+t.from+"-"+t.to,feature:["gene"]});return p.call(e).then(function(t){return t.body})},T=tnt.board.track.data.async().retriever(function(t){return j(t).then(function(t){for(var e=[],n=[],r=0;r<t.length;r++)n.push(t[r].id);var o=l().ensemblRestApi(p).cttvRestApi(v.cttvRestApi).rare(n,v.efo);return e.push(o),i.all(e)}).then(function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];for(var o in r.snps)r.snps.hasOwnProperty(o)&&e.push(r.snps[o])}return e})}),R=function(t){return t.highlight&&e.gene()===t.target.geneid?_.TargetDisease:t.highlight?_.Disease:e.gene()===t.target.geneid?_.Target:_.Other},E=tnt.board.track.feature.pin().domain([.3,1.2]).color(R).index(function(t){return t.name}).on("click",s.snp).layout(tnt.board.track.layout().elements(function(t){a(t,E.scale())})),O=tnt.board.track().label("Variants in rare diseases").height(60).color("white").display(E).data(T),P=tnt.board.track.data.async().retriever(function(t){return j(t).then(function(t){for(var e=[],n=[],r=0;r<t.length;r++)n.push(t[r].id);var o=(t[r],l().ensemblRestApi(p).cttvRestApi(v.cttvRestApi).common(n,v.efo));return e.push(o),i.all(e)}).then(function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];for(var o in r.snps)r.snps.hasOwnProperty(o)&&e.push(r.snps[o])}return e})}),C=tnt.board.track.feature.pin().domain([.3,1.2]).index(function(t){return t.name}).color(R).on("click",s.snp).layout(tnt.board.track.layout().elements(function(t){a(t,E.scale())})),q=tnt.board.track().label("Variants in common diseases").height(60).color("white").display(C).data(P),S=tnt.board.track().label("Genes / Transcripts").height(20).color("#FFFFFF").display(tnt.board.track.feature.block()).data(tnt.board.track.data.sync().retriever(function(){return[]})),N=tnt.board.track().height(y).color("#FFFFFF").display(tnt.board.track.feature.genome.transcript().color(function(t){return t.featureColor}).on("click",s.gene)).data(c);N.display().layout().keep_slots(!1).fixed_slot_type("expanded").on_layout_run(function(t,n){var r=t.expanded.needed_slots*t.expanded.slot_height;r!==y&&(y=200>r?200:r,y=r,N.height(r),e.tracks(e.tracks()))});var z=tnt.board.track().label("sequence").height(30).color("white").display(tnt.board.track.feature.genome.sequence()).data(tnt.board.track.data.genome.sequence().limit(200));b.start(),f=d3.select(r).append("div"),m(h,f.node()),h(r);var I=d3.select(r).append("div").attr("class","tnt_legend_div");I.append("text").attr("class","tnt_legend_header").text("Gene legend:"),d3.selectAll("tnt_biotype").data(N.data().elements()),n=d3.select(r).append("div").attr("class","tnt_legend_div"),n.append("text").attr("class","tnt_legend_header").text("SNPs legend:"),v.show_snps&&(g.common_snps=q,h.add_track(q),g.rare_snps=O,h.add_track(O)),g.gene=N,h.add_track(z).add_track(S).add_track(N);var M=d3.select(r).append("div").attr("class","tnt_links_pane").style("display",function(){return v.show_links?"block":"none"});M.append("span").text("Open in Ensembl");M.append("i").attr("title","open region in ensembl").attr("class","cttvGenomeBrowserIcon fa fa-external-link fa-2x").on("click",function(){var t=A();window.open(t,"_blank")})},w=function(){var t,e=p.url().endpoint("lookup/id/:id").parameters({id:h.gene()}),n=p.call(e).then(function(t){return t.body});if(v.efo){var r=v.cttvRestApi.url.disease({code:v.efo});t=v.cttvRestApi.call(r).then(function(t){return t.body})}var o;o=v.show_snps?l().ensemblRestApi(p).cttvRestApi(v.cttvRestApi).rare(h.gene()):new Promise(function(t,e){t({})});var a;a=v.show_snps?l().ensemblRestApi(p).cttvRestApi(v.cttvRestApi).common(h.gene()):new Promise(function(t,e){t({})}),i.all([n,a,o,t]).then(function(t){var e=t[3],n=t[0];x(n,e);var r=[n.start,n.end],o=t[1].extent,a=t[2].extent,i=o?o[1]-o[0]:0,s=a?a[1]-a[0]:0,u=r[1]-r[0],c=o?~~(o[0]-i/5):1/0,l=o?~~(o[1]+i/5):-(1/0),f=a?~~(a[0]-s/5):1/0,p=a?~~(a[1]+s/5):-(1/0),d=~~(r[0]-u/5),v=~~(r[1]+u/5),g=d3.min([c||1/0,d,f||1/0]),_=d3.max([l||0,v,p||0]);h.chr(n.seq_region_name),m.orig({from:g,to:_}),h.start({from:g,to:_})})},x=function(t,r){var o=[];r&&(o.push({label:"SNP in "+t.display_name+" associated with "+r.label,color:_.TargetDisease}),o.push({label:"SNP associated with "+r.label+" in other genes",color:_.Disease})),o.push({label:"SNP in "+t.display_name,color:_.Target}),o.push({label:"Other SNP",color:_.Other}),e=n.selectAll(".tnt_snp_legend").data(o).enter().append("div").attr("class","tnt_snp_legend"),e.append("div").attr("class","tnt_legend_item").style("display","inline-block").style("margin","0px 5px 0px 15px").style("width","10px").style("height","10px").style("border","1px solid #000").style("border-radius","5px").style("background",function(t){return t.color}),e.append("text").text(function(t){return t.label})};s(b).getset(v).method("start",w).method("track",function(t){switch(t){case"gene":return g.gene;case"common_snps":return g.common_snps;case"rare_snps":return g.rare_snpsf}});var k=function(t){d=d3.select(t).attr("id")},A=function(){var t="http://www.ensembl.org/"+h.species()+"/Location/View?r="+h.chr()+"%3A"+h.from()+"-"+h.to();return t};return b};e.exports=n=f},{"./aggregation.js":66,"./biotypes.js":67,"./navigation.js":68,"./pipelines.js":69,"./tooltips.js":71,"cttv.api":3,rsvp:20,"tnt.api":21}],71:[function(t,e,n){var r=t("tnt.tooltip"),o=t("tnt.api"),a=function(){var t={cttvRestApi:void 0,ensemblRestApi:void 0,prefix:void 0,view:void 0},e=1,n={},a=o(n).getset(t),i=function(e,n){var r={};if(r.header=e.name,r.rows=[],n&&(r.rows.push({label:"Ancestral allele",value:n.ancestral_allele}),r.rows.push({label:"Allele string",value:n.mappings[0].allele_string}),r.rows.push({label:"Most severe consequence",value:n.most_severe_consequence}),n.MAF&&r.rows.push({label:"MAF",value:n.MAF}),r.rows.push({label:"Location",link:function(e){t.view.start({from:e.pos-50,to:e.pos+50})},obj:e,value:"Jump to sequence"}),r.rows.push({label:"target",value:e.target.symbol})),e.associations&&e.associations.length){r.rows.push({label:"Associations",value:""});for(var o=0;o<e.associations.length;o++){var a=e.associations[o];r.rows.push({label:"<a href="+t.prefix+"/evidence/"+e.target.geneid+"/"+a.efo.split("/").pop()+">"+a.label+"</a>",value:a.pmids.length+(1===a.pmids.length?" article":" articles")+"  <a href='http://europepmc.org/search?query="+a.pmids.map(function(t){return"EXT_ID:"+t}).join("%20OR%20")+"' target=_blank <i class='fa fa-newspaper-o fa-lg'></i></a>"})}}if(e.study&&e.study.length){r.rows.push({label:"Associations",value:""});for(var o=0;o<e.study.length;o++)r.rows.push({label:"<a href='"+t.prefix+"/evidence/"+e.target.geneid+"/"+e.study[o].efo.split("/").pop()+"'>"+e.study[o].efo_label+"</a>",value:parseFloat(e.study[o].pvalue).toPrecision(1)+" <a target=_blank href='http://europepmc.org/abstract/med/"+e.study[o].pmid.split("/").pop()+"'><i class='fa fa-newspaper-o fa-lg'></i></a>"})}return r};return a.method("snp",function(n){var r=tnt.tooltip.table().width(250).id(e),o=d3.event,a=this,s=tnt.tooltip.plain().id(e),u=t.ensemblRestApi.url().endpoint("/variation/:species").parameters({species:"human"});t.ensemblRestApi.call(u,{ids:[n.name]})["catch"](function(){console.log("NO VARIANT INFORMATION FOR THIS SNP")}).then(function(t){var e=i(n,t.body[n.name]);r.call(a,e,o)}),s.call(a,{header:n.name,body:"<i class='fa fa-spinner fa-2x fa-spin'></i>"})}),a.method("gene",function(n){var o=function(e,n,r){var o={};o.header=(e.display_name||e.external_name)+" ("+e.id+")",o.rows=[];var a,i;return n&&n.data&&n.data.length>0&&(a="<a href='"+t.prefix+"/target/"+e.id+"/associations'>"+n.data.length+" disease associations</a> ",i="<a href='"+t.prefix+"/target/"+e.id+"'>View CTTV profile</a>"),o.rows.push({label:"Gene",value:""}),o.rows.push({label:"Biotype",value:e.biotype}),o.rows.push({label:"Location",value:"<a target='_blank' href='http://www.ensembl.org/Homo_sapiens/Location/View?db=core;g="+e.id+"'>"+e.seq_region_name+":"+e.start+"-"+e.end+"</a>"}),void 0!==a&&o.rows.push({label:"Associations",value:a}),void 0!==i&&o.rows.push({label:"CTTV Profile",value:i}),o.rows.push({label:"Description",value:e.description}),r&&(o.rows.push({label:"Transcript",value:""}),o.rows.push({label:"Name",value:r.display_name}),o.rows.push({label:"ID",value:"<a target='_blank' href='http://www.ensembl.org/Homo_sapiens/Transcript/Summary?db=core;t="+r.id+"'>"+r.id+"</a>"}),o.rows.push({label:"biotype",value:r.biotype})),o},a=r.table().id(e),i=d3.event,s=this,u=r.plain().id(e),c=t.cttvRestApi.url.associations({target:n.isGene?n.id:n.gene.id,datastructure:"flat",filterbyscorevalue_min:0,stringency:1});t.cttvRestApi.call(c)["catch"](function(t){var e=o(n);a.call(s,e,i)}).then(function(t){var e;e=n.isGene?o(n,t.body):o(n.gene,t.body,n),a.call(s,e,i)}),u.call(s,{header:n.isGene?n.external_name+" ("+n.gene_id+")":n.gene.display_name+"("+n.gene.id+")",body:"<i class='fa fa-spinner fa-2x fa-spin'></i>"})}),n};e.exports=n=a},{"tnt.api":21,"tnt.tooltip":58}]},{},[1]);